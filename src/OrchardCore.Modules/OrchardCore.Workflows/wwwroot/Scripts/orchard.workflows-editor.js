/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

///<reference path='../Lib/jquery/typings.d.ts' />
var applyFilter = function applyFilter(category, q) {
  var type = $('.modal-activities').data('activity-type');
  category = category || $('.activity-picker-categories .nav-link.active').attr('href').substr(1);
  q = q || $('.modal-activities input[type=search]').val();
  var $cards = $('.activity.col').show();
  // Remove activities whoes type doesn't match the configured activity type.
  $cards.filter(function (i, el) {
    return $(el).data('activity-type') != type;
  }).hide();
  if (q.length > 0) {
    // Remove activities whose title doesn't match the query.
    $cards.filter(function (i, el) {
      return $(el).find('.card-title').text().toLowerCase().indexOf(q.toLowerCase()) < 0 && q && q.length > 0;
    }).hide();
  } else {
    // Remove activities whose category doesn't match the selected one.
    $cards.filter(function (i, el) {
      return $(el).data('category').toLowerCase() != category.toLowerCase() && category.toLowerCase() != 'all';
    }).hide();
  }
  // Show or hide categories based on whether there are any available activities.
  $('.activity-picker-categories [data-category]').each(function (i, el) {
    var categoryListItem = $(el);
    var category = categoryListItem.data('category');
    // Count number of activities within this category and for the specified activity type (Event or Task).
    var activityCount = $(".activity.col[data-category='".concat(category, "'][data-activity-type='").concat(type, "']")).length;
    activityCount == 0 ? categoryListItem.hide() : categoryListItem.show();
  });
};
$(function () {
  $('.activity-picker-categories').on('click', '.nav-link', function (e) {
    applyFilter($(e.target).attr('href').substr(1), null);
  });
  $('.modal-activities input[type=search]').on('keyup', function (e) {
    applyFilter(null, $(e.target).val());
  });
  $('#activity-picker').on('show.bs.modal', function (event) {
    var modalEvent = event;
    var button = $(modalEvent.relatedTarget); // Button that triggered the modal.
    var title = button.data('picker-title');
    var type = button.data('activity-type');
    var modal = $(this);
    modal.find('[href="#all"]').click();
    modal.find('.modal-title').text(title);
    modal.data('activity-type', type);
    applyFilter(null, null);
  });
});
///<reference path='../Lib/jquery/typings.d.ts' />
///<reference path='../Lib/jsplumb/typings.d.ts' />
///<reference path='./workflow-models.ts' />
var WorkflowCanvas = /** @class */function () {
  function WorkflowCanvas(container, workflowType) {
    var _this = this;
    this.container = container;
    this.workflowType = workflowType;
    this.minCanvasHeight = 400;
    this.getActivityElements = function () {
      return $(_this.container).find('.activity');
    };
    this.getDefaults = function () {
      return {
        Anchor: "Continuous",
        DragOptions: {
          cursor: 'pointer',
          zIndex: 2000
        },
        EndpointStyles: [{
          fillStyle: '#225588'
        }],
        Endpoints: [["Dot", {
          radius: 7
        }], ["Blank"]],
        ConnectionOverlays: [["Arrow", {
          width: 12,
          length: 12,
          location: -5
        }]],
        ConnectorZIndex: 5
      };
    };
    this.createJsPlumbInstance = function () {
      return jsPlumb.getInstance({
        DragOptions: {
          cursor: 'pointer',
          zIndex: 2000
        },
        ConnectionOverlays: [['Arrow', {
          location: 1,
          visible: true,
          width: 11,
          length: 11
        }], ['Label', {
          location: 0.5,
          id: 'label',
          cssClass: 'connection-label'
        }]],
        Container: _this.container
      });
    };
    this.getEndpointColor = function (activity) {
      return activity.isBlocking || activity.isStart ? '#7ab02c' : activity.isEvent ? '#3a8acd' : '#7ab02c';
    };
    this.getSourceEndpointOptions = function (activity, outcome) {
      // The definition of source endpoints.
      var paintColor = _this.getEndpointColor(activity);
      return {
        endpoint: 'Dot',
        anchor: 'Continuous',
        paintStyle: {
          stroke: paintColor,
          fill: paintColor,
          radius: 7,
          strokeWidth: 1
        },
        isSource: true,
        connector: ['Flowchart', {
          stub: [40, 60],
          gap: 0,
          cornerRadius: 5,
          alwaysRespectStubs: true
        }],
        connectorStyle: {
          strokeWidth: 2,
          stroke: '#999999',
          joinstyle: 'round',
          outlineStroke: 'white',
          outlineWidth: 2
        },
        hoverPaintStyle: {
          fill: '#216477',
          stroke: '#216477'
        },
        connectorHoverStyle: {
          strokeWidth: 3,
          stroke: '#216477',
          outlineWidth: 5,
          outlineStroke: 'white'
        },
        connectorOverlays: [['Label', {
          location: [3, -1.5],
          cssClass: 'endpointSourceLabel'
        }]],
        dragOptions: {},
        uuid: "".concat(activity.id, "-").concat(outcome.name),
        parameters: {
          outcome: outcome
        }
      };
    };
    this.getActivity = function (id, activities) {
      if (activities === void 0) {
        activities = null;
      }
      if (!activities) {
        activities = this.workflowType.activities;
      }
      return $.grep(activities, function (x) {
        return x.id === id;
      })[0];
    };
    this.updateConnections = function (plumber) {
      var workflowId = _this.workflowType.id;
      // Connect activities.
      for (var _i = 0, _a = _this.workflowType.transitions; _i < _a.length; _i++) {
        var transitionModel = _a[_i];
        var sourceEndpointUuid = "".concat(transitionModel.sourceActivityId, "-").concat(transitionModel.sourceOutcomeName);
        var sourceEndpoint = plumber.getEndpoint(sourceEndpointUuid);
        var destinationElementId = "activity-".concat(workflowId, "-").concat(transitionModel.destinationActivityId);
        plumber.connect({
          source: sourceEndpoint,
          target: destinationElementId
        });
      }
    };
    this.updateCanvasHeight = function () {
      var $container = $(this.container);
      // Get the activity element with the highest Y coordinate.
      var $activityElements = $container.find(".activity");
      var currentElementTop = 0;
      var currentActivityHeight = 0;
      for (var _i = 0, _a = $activityElements.toArray(); _i < _a.length; _i++) {
        var activityElement = _a[_i];
        var $activityElement = $(activityElement);
        var top_1 = $activityElement.position().top;
        if (top_1 > currentElementTop) {
          currentElementTop = top_1;
          currentActivityHeight = $activityElement.height();
        }
      }
      var newCanvasHeight = currentElementTop + currentActivityHeight;
      var elementBottom = currentElementTop + currentActivityHeight;
      var stretchValue = 100;
      if (newCanvasHeight - elementBottom <= stretchValue) {
        newCanvasHeight += stretchValue;
      }
      $container.height(Math.max(this.minCanvasHeight, newCanvasHeight));
    };
  }
  return WorkflowCanvas;
}();
///<reference path='../Lib/jquery/typings.d.ts' />
///<reference path='../Lib/jsplumb/typings.d.ts' />
///<reference path='./workflow-models.ts' />
///<reference path='./workflow-canvas.ts' />
var __extends = this && this.__extends || function () {
  var _extendStatics = function extendStatics(d, b) {
    _extendStatics = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function (d, b) {
      d.__proto__ = b;
    } || function (d, b) {
      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];
    };
    return _extendStatics(d, b);
  };
  return function (d, b) {
    if (typeof b !== "function" && b !== null) throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    _extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
// TODO: Re-implement this using a MVVM approach.
var WorkflowEditor = /** @class */function (_super) {
  __extends(WorkflowEditor, _super);
  function WorkflowEditor(container, workflowType, deleteActivityPrompt, localId, loadLocalState) {
    var _this = _super.call(this, container, workflowType) || this;
    _this.container = container;
    _this.workflowType = workflowType;
    _this.deleteActivityPrompt = deleteActivityPrompt;
    _this.localId = localId;
    _this.getState = function () {
      var $allActivityElements = $(_this.container).find('.activity');
      var workflow = {
        id: _this.workflowType.id,
        activities: [],
        transitions: [],
        removedActivities: _this.workflowType.removedActivities
      };
      // Collect activities.
      for (var i = 0; i < $allActivityElements.length; i++) {
        var $activityElement = $($allActivityElements[i]);
        var activityId = $activityElement.data('activity-id');
        var activityIsStart = $activityElement.data('activity-start');
        var activityIsEvent = $activityElement.data('activity-type') === 'Event';
        var activityPosition = $activityElement.position();
        var activity = _this.getActivity(activityId);
        workflow.activities.push({
          id: activityId,
          isStart: activityIsStart,
          isEvent: activityIsEvent,
          outcomes: activity.outcomes,
          x: activityPosition.left,
          y: activityPosition.top
        });
      }
      // Collect connections.
      var allConnections = _this.jsPlumbInstance.getConnections();
      for (var i = 0; i < allConnections.length; i++) {
        var connection = allConnections[i];
        var sourceEndpoint = connection.endpoints[0];
        var sourceOutcomeName = sourceEndpoint.getParameters().outcome.name;
        var sourceActivityId = $(connection.source).data('activity-id');
        var destinationActivityId = $(connection.target).data('activity-id');
        workflow.transitions.push({
          sourceActivityId: sourceActivityId,
          destinationActivityId: destinationActivityId,
          sourceOutcomeName: sourceOutcomeName
        });
      }
      return workflow;
    };
    _this.serialize = function () {
      var workflow = _this.getState();
      return JSON.stringify(workflow);
    };
    _this.saveLocalState = function () {
      sessionStorage[_this.localId] = _this.serialize();
    };
    _this.loadLocalState = function () {
      return JSON.parse(sessionStorage[_this.localId]);
    };
    var self = _this;
    jsPlumb.ready(function () {
      jsPlumb.importDefaults(_this.getDefaults());
      var plumber = _this.createJsPlumbInstance();
      // Listen for new connections.
      plumber.bind('connection', function (connInfo, originalEvent) {
        var connection = connInfo.connection;
        var outcome = connection.getParameters().outcome;
        var label = connection.getOverlay('label');
        label.setLabel(outcome.displayName);
      });
      var activityElements = _this.getActivityElements();
      var areEqualOutcomes = function areEqualOutcomes(outcomes1, outcomes2) {
        if (outcomes1.length != outcomes2.length) {
          return false;
        }
        for (var i = 0; i < outcomes1.length; i++) {
          var outcome1 = outcomes1[i];
          var outcome2 = outcomes2[i];
          if (outcome1.name != outcome2.displayName || outcome1.displayName != outcome2.displayName) {
            return false;
          }
        }
        return true;
      };
      // Suspend drawing and initialize.
      plumber.batch(function () {
        var serverworkflowType = _this.workflowType;
        var workflowId = _this.workflowType.id;
        if (loadLocalState) {
          var localState = _this.loadLocalState();
          if (localState) {
            _this.workflowType = localState;
          }
        }
        activityElements.each(function (_, activityElement) {
          var $activityElement = $(activityElement);
          var activityId = $activityElement.data('activity-id');
          var isDeleted = _this.workflowType.removedActivities.indexOf(activityId) > -1;
          if (isDeleted) {
            $activityElement.remove();
            return;
          }
          var activity = _this.getActivity(activityId);
          var serverActivity = _this.getActivity(activityId, serverworkflowType.activities);
          // Update the activity's visual state.
          if (loadLocalState) {
            if (activity == null) {
              // This is a newly added activity not yet added to local state.
              activity = serverActivity;
              _this.workflowType.activities.push(activity);
              activity.x = 50;
              activity.y = 50;
            } else {
              // The available outcomes might have changed when editing an activity,
              // so we need to check for that and update the client's activity outcomes if so.
              var sameOutcomes = areEqualOutcomes(activity.outcomes, serverActivity.outcomes);
              if (!sameOutcomes) {
                activity.outcomes = serverActivity.outcomes;
              }
              $activityElement.css({
                left: activity.x,
                top: activity.y
              }).toggleClass('activity-start', activity.isStart).data('activity-start', activity.isStart);
            }
          }
          // Make the activity draggable.
          plumber.draggable(activityElement, {
            grid: [10, 10],
            containment: true,
            start: function start(args) {
              _this.dragStart = {
                left: args.e.screenX,
                top: args.e.screenY
              };
            },
            stop: function stop(args) {
              _this.hasDragged = _this.dragStart.left != args.e.screenX || _this.dragStart.top != args.e.screenY;
              _this.updateCanvasHeight();
            }
          });
          // Configure the activity as a target.
          plumber.makeTarget(activityElement, {
            dropOptions: {
              hoverClass: 'hover'
            },
            anchor: 'Continuous',
            endpoint: ['Blank', {
              radius: 8
            }]
          });
          // Add source endpoints.
          for (var _i = 0, _a = activity.outcomes; _i < _a.length; _i++) {
            var outcome = _a[_i];
            var sourceEndpointOptions = _this.getSourceEndpointOptions(activity, outcome);
            plumber.addEndpoint(activityElement, {
              connectorOverlays: [['Label', {
                label: outcome.displayName,
                cssClass: 'connection-label'
              }]]
            }, sourceEndpointOptions);
          }
        });
        // Connect activities.
        _this.updateConnections(plumber);
        // Re-query the activity elements.
        activityElements = _this.getActivityElements();
        // Make all activity elements visible.
        activityElements.show();
        _this.updateCanvasHeight();
      });
      // Initialize popovers.
      activityElements.each(function (_, item) {
        var activityElement = $(item);
        activityElement.popover({
          trigger: 'manual',
          html: true,
          content: function content() {
            var $content = activityElement.find('.activity-commands').clone();
            var startButton = $content.find('.activity-start-action');
            var isStart = activityElement.data('activity-start') === true;
            var activityId = activityElement.data('activity-id');
            startButton.attr('aria-pressed', activityElement.data('activity-start'));
            startButton.toggleClass('active', isStart);
            $content.on('click', '.activity-start-action', function (e) {
              e.preventDefault();
              var button = $(e.currentTarget);
              var isStart = button.is('.active');
              activityElement.data('activity-start', isStart);
              activityElement.toggleClass('activity-start', isStart);
            });
            $content.on('click', '.activity-delete-action', function (e) {
              e.preventDefault();
              // TODO: The prompts are really annoying. Consider showing some sort of small message balloon somewhere to undo the action instead.
              //if (!confirm(self.deleteActivityPrompt)) {
              //    return;
              //}
              self.workflowType.removedActivities.push(activityId);
              plumber.remove(activityElement);
              activityElement.popover('dispose');
            });
            $content.on('click', '[data-persist-workflow]', function (e) {
              self.saveLocalState();
            });
            return $content.get(0);
          }
        });
      });
      $(container).on('click', '.activity', function (e) {
        if (_this.hasDragged) {
          _this.hasDragged = false;
          return;
        }
        // if any other popovers are visible, hide them
        if (_this.isPopoverVisible) {
          activityElements.popover('hide');
        }
        var sender = $(e.currentTarget);
        sender.popover('show');
        // handle clicking on the popover itself.
        $('.popover').off('click').on('click', function (e2) {
          e2.stopPropagation();
        });
        e.stopPropagation();
        _this.isPopoverVisible = true;
      });
      $(container).on('dblclick', '.activity', function (e) {
        var sender = $(e.currentTarget);
        var hasEditor = sender.data('activity-has-editor');
        if (hasEditor) {
          _this.saveLocalState();
          sender.find('.activity-edit-action').get(0).click();
        }
      });
      // Hide all popovers when clicking anywhere but on an activity.
      $('body').on('click', function (e) {
        activityElements.popover('hide');
        _this.isPopoverVisible = false;
      });
      // Save local changes if the event target has the 'data-persist-workflow' attribute.
      $('body').on('click', '[data-persist-workflow]', function (e) {
        _this.saveLocalState();
      });
      _this.jsPlumbInstance = plumber;
    });
    return _this;
  }
  return WorkflowEditor;
}(WorkflowCanvas);
$.fn.workflowEditor = function () {
  this.each(function (index, element) {
    var $element = $(element);
    var workflowType = $element.data('workflow-type');
    var deleteActivityPrompt = $element.data('workflow-delete-activity-prompt');
    var localId = $element.data('workflow-local-id');
    var loadLocalState = $element.data('workflow-load-local-state');
    workflowType.removedActivities = workflowType.removedActivities || [];
    $element.data('workflowEditor', new WorkflowEditor(element, workflowType, deleteActivityPrompt, localId, loadLocalState));
  });
  return this;
};
$(document).ready(function () {
  var workflowEditor = $('.workflow-canvas').workflowEditor().data('workflowEditor');
  $('#workflowEditorForm').on('submit', function (s, e) {
    var state = workflowEditor.serialize();
    $('#workflowStateInput').val(state);
  });
});
///<reference path="../../../Assets/Lib/jquery/typings.d.ts" />
$(function () {
  var generateWorkflowUrl = function generateWorkflowUrl() {
    var workflowTypeId = $('[data-workflow-type-id]').data('workflow-type-id');
    var activityId = $('[data-activity-id]').data('activity-id');
    var tokenLifeSpan = $('#token-lifespan').val();
    var generateUrl = $('[data-generate-url]').data('generate-url') + "?workflowTypeId=".concat(workflowTypeId, "&activityId=").concat(activityId, "&tokenLifeSpan=").concat(tokenLifeSpan);
    var antiforgeryHeaderName = $('[data-antiforgery-header-name]').data('antiforgery-header-name');
    var antiforgeryToken = $('[data-antiforgery-token]').data('antiforgery-token');
    var headers = {};
    headers[antiforgeryHeaderName] = antiforgeryToken;
    $.post({
      url: generateUrl,
      headers: headers
    }).done(function (url) {
      $('#workflow-url-text').val(url);
    });
  };
  $('#generate-url-button').on('click', function (e) {
    generateWorkflowUrl();
  });
  if ($('#workflow-url-text').val() == '') {
    generateWorkflowUrl();
  }
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjdGl2aXR5LXBpY2tlci50cyIsIndvcmtmbG93LWNhbnZhcy50cyIsIndvcmtmbG93LWNhbnZhcy5qcyIsIndvcmtmbG93LWVkaXRvci50cyIsIndvcmtmbG93LWVkaXRvci5qcyIsIndvcmtmbG93LXVybC1nZW5lcmF0b3IudHMiLCJ3b3JrZmxvdy11cmwtZ2VuZXJhdG9yLmpzIl0sIm5hbWVzIjpbImFwcGx5RmlsdGVyIiwiY2F0ZWdvcnkiLCJxIiwidHlwZSIsIiQiLCJkYXRhIiwiYXR0ciIsInN1YnN0ciIsInZhbCIsIiRjYXJkcyIsInNob3ciLCJmaWx0ZXIiLCJpIiwiZWwiLCJoaWRlIiwibGVuZ3RoIiwiZmluZCIsInRleHQiLCJ0b0xvd2VyQ2FzZSIsImluZGV4T2YiLCJlYWNoIiwiY2F0ZWdvcnlMaXN0SXRlbSIsImFjdGl2aXR5Q291bnQiLCJjb25jYXQiLCJvbiIsImUiLCJ0YXJnZXQiLCJldmVudCIsIm1vZGFsRXZlbnQiLCJidXR0b24iLCJyZWxhdGVkVGFyZ2V0IiwidGl0bGUiLCJtb2RhbCIsImNsaWNrIiwiV29ya2Zsb3dDYW52YXMiLCJjb250YWluZXIiLCJ3b3JrZmxvd1R5cGUiLCJfdGhpcyIsIm1pbkNhbnZhc0hlaWdodCIsImdldEFjdGl2aXR5RWxlbWVudHMiLCJnZXREZWZhdWx0cyIsIkFuY2hvciIsIkRyYWdPcHRpb25zIiwiY3Vyc29yIiwiekluZGV4IiwiRW5kcG9pbnRTdHlsZXMiLCJmaWxsU3R5bGUiLCJFbmRwb2ludHMiLCJyYWRpdXMiLCJDb25uZWN0aW9uT3ZlcmxheXMiLCJ3aWR0aCIsImxvY2F0aW9uIiwiQ29ubmVjdG9yWkluZGV4IiwiY3JlYXRlSnNQbHVtYkluc3RhbmNlIiwianNQbHVtYiIsImdldEluc3RhbmNlIiwidmlzaWJsZSIsImlkIiwiY3NzQ2xhc3MiLCJDb250YWluZXIiLCJnZXRFbmRwb2ludENvbG9yIiwiYWN0aXZpdHkiLCJpc0Jsb2NraW5nIiwiaXNTdGFydCIsImlzRXZlbnQiLCJnZXRTb3VyY2VFbmRwb2ludE9wdGlvbnMiLCJvdXRjb21lIiwicGFpbnRDb2xvciIsImVuZHBvaW50IiwiYW5jaG9yIiwicGFpbnRTdHlsZSIsInN0cm9rZSIsImZpbGwiLCJzdHJva2VXaWR0aCIsImlzU291cmNlIiwiY29ubmVjdG9yIiwic3R1YiIsImdhcCIsImNvcm5lclJhZGl1cyIsImFsd2F5c1Jlc3BlY3RTdHVicyIsImNvbm5lY3RvclN0eWxlIiwiam9pbnN0eWxlIiwib3V0bGluZVN0cm9rZSIsIm91dGxpbmVXaWR0aCIsImhvdmVyUGFpbnRTdHlsZSIsImNvbm5lY3RvckhvdmVyU3R5bGUiLCJjb25uZWN0b3JPdmVybGF5cyIsImRyYWdPcHRpb25zIiwidXVpZCIsIm5hbWUiLCJwYXJhbWV0ZXJzIiwiZ2V0QWN0aXZpdHkiLCJhY3Rpdml0aWVzIiwiZ3JlcCIsIngiLCJ1cGRhdGVDb25uZWN0aW9ucyIsInBsdW1iZXIiLCJ3b3JrZmxvd0lkIiwiX2kiLCJfYSIsInRyYW5zaXRpb25zIiwidHJhbnNpdGlvbk1vZGVsIiwic291cmNlRW5kcG9pbnRVdWlkIiwic291cmNlQWN0aXZpdHlJZCIsInNvdXJjZU91dGNvbWVOYW1lIiwic291cmNlRW5kcG9pbnQiLCJnZXRFbmRwb2ludCIsImRlc3RpbmF0aW9uRWxlbWVudElkIiwiZGVzdGluYXRpb25BY3Rpdml0eUlkIiwiY29ubmVjdCIsInNvdXJjZSIsInVwZGF0ZUNhbnZhc0hlaWdodCIsIiRjb250YWluZXIiLCIkYWN0aXZpdHlFbGVtZW50cyIsImN1cnJlbnRFbGVtZW50VG9wIiwiY3VycmVudEFjdGl2aXR5SGVpZ2h0IiwidG9BcnJheSIsImFjdGl2aXR5RWxlbWVudCIsIiRhY3Rpdml0eUVsZW1lbnQiLCJ0b3BfMSIsInBvc2l0aW9uIiwidG9wIiwiaGVpZ2h0IiwibmV3Q2FudmFzSGVpZ2h0IiwiZWxlbWVudEJvdHRvbSIsInN0cmV0Y2hWYWx1ZSIsIk1hdGgiLCJtYXgiLCJfX2V4dGVuZHMiLCJleHRlbmRTdGF0aWNzIiwiZCIsImIiLCJPYmplY3QiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIkFycmF5IiwicCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlR5cGVFcnJvciIsIlN0cmluZyIsIl9fIiwiY29uc3RydWN0b3IiLCJjcmVhdGUiLCJXb3JrZmxvd0VkaXRvciIsIl9zdXBlciIsImRlbGV0ZUFjdGl2aXR5UHJvbXB0IiwibG9jYWxJZCIsImxvYWRMb2NhbFN0YXRlIiwiZ2V0U3RhdGUiLCIkYWxsQWN0aXZpdHlFbGVtZW50cyIsIndvcmtmbG93IiwicmVtb3ZlZEFjdGl2aXRpZXMiLCJhY3Rpdml0eUlkIiwiYWN0aXZpdHlJc1N0YXJ0IiwiYWN0aXZpdHlJc0V2ZW50IiwiYWN0aXZpdHlQb3NpdGlvbiIsInB1c2giLCJvdXRjb21lcyIsImxlZnQiLCJ5IiwiYWxsQ29ubmVjdGlvbnMiLCJqc1BsdW1iSW5zdGFuY2UiLCJnZXRDb25uZWN0aW9ucyIsImNvbm5lY3Rpb24iLCJlbmRwb2ludHMiLCJnZXRQYXJhbWV0ZXJzIiwic2VyaWFsaXplIiwiSlNPTiIsInN0cmluZ2lmeSIsInNhdmVMb2NhbFN0YXRlIiwic2Vzc2lvblN0b3JhZ2UiLCJwYXJzZSIsInNlbGYiLCJyZWFkeSIsImltcG9ydERlZmF1bHRzIiwiYmluZCIsImNvbm5JbmZvIiwib3JpZ2luYWxFdmVudCIsImxhYmVsIiwiZ2V0T3ZlcmxheSIsInNldExhYmVsIiwiZGlzcGxheU5hbWUiLCJhY3Rpdml0eUVsZW1lbnRzIiwiYXJlRXF1YWxPdXRjb21lcyIsIm91dGNvbWVzMSIsIm91dGNvbWVzMiIsIm91dGNvbWUxIiwib3V0Y29tZTIiLCJiYXRjaCIsInNlcnZlcndvcmtmbG93VHlwZSIsImxvY2FsU3RhdGUiLCJfIiwiaXNEZWxldGVkIiwicmVtb3ZlIiwic2VydmVyQWN0aXZpdHkiLCJzYW1lT3V0Y29tZXMiLCJjc3MiLCJ0b2dnbGVDbGFzcyIsImRyYWdnYWJsZSIsImdyaWQiLCJjb250YWlubWVudCIsInN0YXJ0IiwiYXJncyIsImRyYWdTdGFydCIsInNjcmVlblgiLCJzY3JlZW5ZIiwic3RvcCIsImhhc0RyYWdnZWQiLCJtYWtlVGFyZ2V0IiwiZHJvcE9wdGlvbnMiLCJob3ZlckNsYXNzIiwic291cmNlRW5kcG9pbnRPcHRpb25zIiwiYWRkRW5kcG9pbnQiLCJpdGVtIiwicG9wb3ZlciIsInRyaWdnZXIiLCJodG1sIiwiY29udGVudCIsIiRjb250ZW50IiwiY2xvbmUiLCJzdGFydEJ1dHRvbiIsInByZXZlbnREZWZhdWx0IiwiY3VycmVudFRhcmdldCIsImlzIiwiZ2V0IiwiaXNQb3BvdmVyVmlzaWJsZSIsInNlbmRlciIsIm9mZiIsImUyIiwic3RvcFByb3BhZ2F0aW9uIiwiaGFzRWRpdG9yIiwiZm4iLCJ3b3JrZmxvd0VkaXRvciIsImluZGV4IiwiZWxlbWVudCIsIiRlbGVtZW50IiwiZG9jdW1lbnQiLCJzIiwic3RhdGUiLCJnZW5lcmF0ZVdvcmtmbG93VXJsIiwid29ya2Zsb3dUeXBlSWQiLCJ0b2tlbkxpZmVTcGFuIiwiZ2VuZXJhdGVVcmwiLCJhbnRpZm9yZ2VyeUhlYWRlck5hbWUiLCJhbnRpZm9yZ2VyeVRva2VuIiwiaGVhZGVycyIsInBvc3QiLCJ1cmwiLCJkb25lIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBRUEsSUFBSUEsV0FBVyxHQUFHLFNBQWRBLFdBQVdBLENBQWFDLFFBQWdCLEVBQUVDLENBQVMsRUFBQTtFQUNuRCxJQUFNQyxJQUFJLEdBQUdDLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDQyxJQUFJLENBQUMsZUFBZSxDQUFDO0VBQ3pESixRQUFRLEdBQUdBLFFBQVEsSUFBSUcsQ0FBQyxDQUFDLDhDQUE4QyxDQUFDLENBQUNFLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQ0MsTUFBTSxDQUFDLENBQUMsQ0FBQztFQUMvRkwsQ0FBQyxHQUFHQSxDQUFDLElBQVlFLENBQUMsQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDSSxHQUFHLENBQUEsQ0FBRTtFQUVoRSxJQUFNQyxNQUFNLEdBQUdMLENBQUMsQ0FBQyxl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OiJvcmNoYXJkLndvcmtmbG93cy1lZGl0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy88cmVmZXJlbmNlIHBhdGg9Jy4uL0xpYi9qcXVlcnkvdHlwaW5ncy5kLnRzJyAvPlxyXG5cclxudmFyIGFwcGx5RmlsdGVyID0gZnVuY3Rpb24gKGNhdGVnb3J5OiBzdHJpbmcsIHE6IHN0cmluZykge1xyXG4gICAgY29uc3QgdHlwZSA9ICQoJy5tb2RhbC1hY3Rpdml0aWVzJykuZGF0YSgnYWN0aXZpdHktdHlwZScpO1xyXG4gICAgY2F0ZWdvcnkgPSBjYXRlZ29yeSB8fCAkKCcuYWN0aXZpdHktcGlja2VyLWNhdGVnb3JpZXMgLm5hdi1saW5rLmFjdGl2ZScpLmF0dHIoJ2hyZWYnKS5zdWJzdHIoMSk7XHJcbiAgICBxID0gcSB8fCA8c3RyaW5nPiQoJy5tb2RhbC1hY3Rpdml0aWVzIGlucHV0W3R5cGU9c2VhcmNoXScpLnZhbCgpO1xyXG5cclxuICAgIGNvbnN0ICRjYXJkcyA9ICQoJy5hY3Rpdml0eS5jb2wnKS5zaG93KCk7XHJcblxyXG4gICAgLy8gUmVtb3ZlIGFjdGl2aXRpZXMgd2hvZXMgdHlwZSBkb2Vzbid0IG1hdGNoIHRoZSBjb25maWd1cmVkIGFjdGl2aXR5IHR5cGUuXHJcbiAgICAkY2FyZHMuZmlsdGVyKChpLCBlbCkgPT4ge1xyXG4gICAgICAgIHJldHVybiAkKGVsKS5kYXRhKCdhY3Rpdml0eS10eXBlJykgIT0gdHlwZTtcclxuICAgIH0pLmhpZGUoKTtcclxuXHJcbiAgICBpZiAocS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgLy8gUmVtb3ZlIGFjdGl2aXRpZXMgd2hvc2UgdGl0bGUgZG9lc24ndCBtYXRjaCB0aGUgcXVlcnkuXHJcbiAgICAgICAgJGNhcmRzLmZpbHRlcigoaSwgZWwpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuICQoZWwpLmZpbmQoJy5jYXJkLXRpdGxlJykudGV4dCgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihxLnRvTG93ZXJDYXNlKCkpIDwgMCAmJiBxICYmIHEubGVuZ3RoID4gMDtcclxuICAgICAgICB9KS5oaWRlKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBSZW1vdmUgYWN0aXZpdGllcyB3aG9zZSBjYXRlZ29yeSBkb2Vzbid0IG1hdGNoIHRoZSBzZWxlY3RlZCBvbmUuXHJcbiAgICAgICAgJGNhcmRzLmZpbHRlcigoaSwgZWwpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuICQoZWwpLmRhdGEoJ2NhdGVnb3J5JykudG9Mb3dlckNhc2UoKSAhPSBjYXRlZ29yeS50b0xvd2VyQ2FzZSgpICYmIGNhdGVnb3J5LnRvTG93ZXJDYXNlKCkgIT0gJ2FsbCc7XHJcbiAgICAgICAgfSkuaGlkZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNob3cgb3IgaGlkZSBjYXRlZ29yaWVzIGJhc2VkIG9uIHdoZXRoZXIgdGhlcmUgYXJlIGFueSBhdmFpbGFibGUgYWN0aXZpdGllcy5cclxuICAgICQoJy5hY3Rpdml0eS1waWNrZXItY2F0ZWdvcmllcyBbZGF0YS1jYXRlZ29yeV0nKS5lYWNoKChpLCBlbCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3J5TGlzdEl0ZW0gPSAkKGVsKTtcclxuICAgICAgICBjb25zdCBjYXRlZ29yeSA9IGNhdGVnb3J5TGlzdEl0ZW0uZGF0YSgnY2F0ZWdvcnknKTtcclxuXHJcbiAgICAgICAgLy8gQ291bnQgbnVtYmVyIG9mIGFjdGl2aXRpZXMgd2l0aGluIHRoaXMgY2F0ZWdvcnkgYW5kIGZvciB0aGUgc3BlY2lmaWVkIGFjdGl2aXR5IHR5cGUgKEV2ZW50IG9yIFRhc2spLlxyXG4gICAgICAgIGNvbnN0IGFjdGl2aXR5Q291bnQgPSAkKGAuYWN0aXZpdHkuY29sW2RhdGEtY2F0ZWdvcnk9JyR7Y2F0ZWdvcnl9J11bZGF0YS1hY3Rpdml0eS10eXBlPScke3R5cGV9J11gKS5sZW5ndGg7XHJcbiAgICAgICAgYWN0aXZpdHlDb3VudCA9PSAwID8gY2F0ZWdvcnlMaXN0SXRlbS5oaWRlKCkgOiBjYXRlZ29yeUxpc3RJdGVtLnNob3coKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuJCgoKSA9PiB7XHJcbiAgICAkKCcuYWN0aXZpdHktcGlja2VyLWNhdGVnb3JpZXMnKS5vbignY2xpY2snLCAnLm5hdi1saW5rJywgZSA9PiB7XHJcbiAgICAgICAgYXBwbHlGaWx0ZXIoJChlLnRhcmdldCkuYXR0cignaHJlZicpLnN1YnN0cigxKSwgbnVsbCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcubW9kYWwtYWN0aXZpdGllcyBpbnB1dFt0eXBlPXNlYXJjaF0nKS5vbigna2V5dXAnLCBlID0+IHtcclxuICAgICAgICBhcHBseUZpbHRlcihudWxsLCA8c3RyaW5nPiQoZS50YXJnZXQpLnZhbCgpKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNhY3Rpdml0eS1waWNrZXInKS5vbignc2hvdy5icy5tb2RhbCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIHZhciBtb2RhbEV2ZW50ID0gZXZlbnQgYXMgYW55O1xyXG4gICAgICAgIHZhciBidXR0b24gPSAkKG1vZGFsRXZlbnQucmVsYXRlZFRhcmdldCk7IC8vIEJ1dHRvbiB0aGF0IHRyaWdnZXJlZCB0aGUgbW9kYWwuXHJcbiAgICAgICAgdmFyIHRpdGxlID0gYnV0dG9uLmRhdGEoJ3BpY2tlci10aXRsZScpO1xyXG4gICAgICAgIHZhciB0eXBlID0gYnV0dG9uLmRhdGEoJ2FjdGl2aXR5LXR5cGUnKTtcclxuICAgICAgICB2YXIgbW9kYWwgPSAkKHRoaXMpO1xyXG4gICAgICAgIG1vZGFsLmZpbmQoJ1tocmVmPVwiI2FsbFwiXScpLmNsaWNrKCk7XHJcbiAgICAgICAgbW9kYWwuZmluZCgnLm1vZGFsLXRpdGxlJykudGV4dCh0aXRsZSk7XHJcbiAgICAgICAgbW9kYWwuZGF0YSgnYWN0aXZpdHktdHlwZScsIHR5cGUpO1xyXG4gICAgICAgIGFwcGx5RmlsdGVyKG51bGwsIG51bGwpO1xyXG4gICAgfSlcclxufSk7XHJcbiIsIi8vLzxyZWZlcmVuY2UgcGF0aD0nLi4vTGliL2pxdWVyeS90eXBpbmdzLmQudHMnIC8+XHJcbi8vLzxyZWZlcmVuY2UgcGF0aD0nLi4vTGliL2pzcGx1bWIvdHlwaW5ncy5kLnRzJyAvPlxyXG4vLy88cmVmZXJlbmNlIHBhdGg9Jy4vd29ya2Zsb3ctbW9kZWxzLnRzJyAvPlxyXG5cclxuYWJzdHJhY3QgY2xhc3MgV29ya2Zsb3dDYW52YXMge1xyXG4gICAgcHJpdmF0ZSBtaW5DYW52YXNIZWlnaHQ6IG51bWJlciA9IDQwMDtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcHJvdGVjdGVkIHdvcmtmbG93VHlwZTogV29ya2Zsb3dzLldvcmtmbG93VHlwZSkge1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBnZXRBY3Rpdml0eUVsZW1lbnRzID0gKCk6IEpRdWVyeSA9PiB7XHJcbiAgICAgICAgcmV0dXJuICQodGhpcy5jb250YWluZXIpLmZpbmQoJy5hY3Rpdml0eScpO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBnZXREZWZhdWx0cyA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBBbmNob3I6IFwiQ29udGludW91c1wiLFxyXG4gICAgICAgICAgICBEcmFnT3B0aW9uczogeyBjdXJzb3I6ICdwb2ludGVyJywgekluZGV4OiAyMDAwIH0sXHJcbiAgICAgICAgICAgIEVuZHBvaW50U3R5bGVzOiBbeyBmaWxsU3R5bGU6ICcjMjI1NTg4JyB9XSxcclxuICAgICAgICAgICAgRW5kcG9pbnRzOiBbW1wiRG90XCIsIHsgcmFkaXVzOiA3IH1dLCBbXCJCbGFua1wiXV0sXHJcbiAgICAgICAgICAgIENvbm5lY3Rpb25PdmVybGF5czogW1xyXG4gICAgICAgICAgICAgICAgW1wiQXJyb3dcIiwgeyB3aWR0aDogMTIsIGxlbmd0aDogMTIsIGxvY2F0aW9uOiAtNSB9XSxcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgQ29ubmVjdG9yWkluZGV4OiA1XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBwcm90ZWN0ZWQgY3JlYXRlSnNQbHVtYkluc3RhbmNlID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBqc1BsdW1iLmdldEluc3RhbmNlKHtcclxuICAgICAgICAgICAgRHJhZ09wdGlvbnM6IHsgY3Vyc29yOiAncG9pbnRlcicsIHpJbmRleDogMjAwMCB9LFxyXG4gICAgICAgICAgICBDb25uZWN0aW9uT3ZlcmxheXM6IFtcclxuICAgICAgICAgICAgICAgIFsnQXJyb3cnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb246IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTEsXHJcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAxMVxyXG4gICAgICAgICAgICAgICAgfV0sXHJcbiAgICAgICAgICAgICAgICBbJ0xhYmVsJywge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiAwLjUsXHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICdsYWJlbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgY3NzQ2xhc3M6ICdjb25uZWN0aW9uLWxhYmVsJ1xyXG4gICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgQ29udGFpbmVyOiB0aGlzLmNvbnRhaW5lclxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBwcm90ZWN0ZWQgZ2V0RW5kcG9pbnRDb2xvciA9IChhY3Rpdml0eTogV29ya2Zsb3dzLkFjdGl2aXR5KSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGFjdGl2aXR5LmlzQmxvY2tpbmcgfHwgYWN0aXZpdHkuaXNTdGFydCA/ICcjN2FiMDJjJyA6IGFjdGl2aXR5LmlzRXZlbnQgPyAnIzNhOGFjZCcgOiAnIzdhYjAyYyc7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGdldFNvdXJjZUVuZHBvaW50T3B0aW9ucyA9IChhY3Rpdml0eTogV29ya2Zsb3dzLkFjdGl2aXR5LCBvdXRjb21lOiBXb3JrZmxvd3MuT3V0Y29tZSk6IEVuZHBvaW50T3B0aW9ucyA9PiB7XHJcbiAgICAgICAgLy8gVGhlIGRlZmluaXRpb24gb2Ygc291cmNlIGVuZHBvaW50cy5cclxuICAgICAgICBjb25zdCBwYWludENvbG9yID0gdGhpcy5nZXRFbmRwb2ludENvbG9yKGFjdGl2aXR5KTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBlbmRwb2ludDogJ0RvdCcsXHJcbiAgICAgICAgICAgIGFuY2hvcjogJ0NvbnRpbnVvdXMnLFxyXG4gICAgICAgICAgICBwYWludFN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IHBhaW50Q29sb3IsXHJcbiAgICAgICAgICAgICAgICBmaWxsOiBwYWludENvbG9yLFxyXG4gICAgICAgICAgICAgICAgcmFkaXVzOiA3LFxyXG4gICAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgaXNTb3VyY2U6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbm5lY3RvcjogWydGbG93Y2hhcnQnLCB7IHN0dWI6IFs0MCwgNjBdLCBnYXA6IDAsIGNvcm5lclJhZGl1czogNSwgYWx3YXlzUmVzcGVjdFN0dWJzOiB0cnVlIH1dLFxyXG4gICAgICAgICAgICBjb25uZWN0b3JTdHlsZToge1xyXG4gICAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDIsXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6ICcjOTk5OTk5JyxcclxuICAgICAgICAgICAgICAgIGpvaW5zdHlsZTogJ3JvdW5kJyxcclxuICAgICAgICAgICAgICAgIG91dGxpbmVTdHJva2U6ICd3aGl0ZScsXHJcbiAgICAgICAgICAgICAgICBvdXRsaW5lV2lkdGg6IDJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgaG92ZXJQYWludFN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICBmaWxsOiAnIzIxNjQ3NycsXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6ICcjMjE2NDc3J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb25uZWN0b3JIb3ZlclN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICBzdHJva2VXaWR0aDogMyxcclxuICAgICAgICAgICAgICAgIHN0cm9rZTogJyMyMTY0NzcnLFxyXG4gICAgICAgICAgICAgICAgb3V0bGluZVdpZHRoOiA1LFxyXG4gICAgICAgICAgICAgICAgb3V0bGluZVN0cm9rZTogJ3doaXRlJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb25uZWN0b3JPdmVybGF5czogW1snTGFiZWwnLCB7IGxvY2F0aW9uOiBbMywgLTEuNV0sIGNzc0NsYXNzOiAnZW5kcG9pbnRTb3VyY2VMYWJlbCcgfV1dLFxyXG4gICAgICAgICAgICBkcmFnT3B0aW9uczoge30sXHJcbiAgICAgICAgICAgIHV1aWQ6IGAke2FjdGl2aXR5LmlkfS0ke291dGNvbWUubmFtZX1gLFxyXG4gICAgICAgICAgICBwYXJhbWV0ZXJzOiB7XHJcbiAgICAgICAgICAgICAgICBvdXRjb21lOiBvdXRjb21lXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBwcm90ZWN0ZWQgZ2V0QWN0aXZpdHkgPSBmdW5jdGlvbiAoaWQ6IHN0cmluZywgYWN0aXZpdGllczogQXJyYXk8V29ya2Zsb3dzLkFjdGl2aXR5PiA9IG51bGwpOiBXb3JrZmxvd3MuQWN0aXZpdHkge1xyXG4gICAgICAgIGlmICghYWN0aXZpdGllcykge1xyXG4gICAgICAgICAgICBhY3Rpdml0aWVzID0gdGhpcy53b3JrZmxvd1R5cGUuYWN0aXZpdGllcztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICQuZ3JlcChhY3Rpdml0aWVzLCAoeDogV29ya2Zsb3dzLkFjdGl2aXR5KSA9PiB4LmlkID09PSBpZClbMF07XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIHVwZGF0ZUNvbm5lY3Rpb25zID0gKHBsdW1iZXI6IGpzUGx1bWJJbnN0YW5jZSkgPT4ge1xyXG4gICAgICAgIHZhciB3b3JrZmxvd0lkOiBudW1iZXIgPSB0aGlzLndvcmtmbG93VHlwZS5pZDtcclxuXHJcbiAgICAgICAgLy8gQ29ubmVjdCBhY3Rpdml0aWVzLlxyXG4gICAgICAgIGZvciAobGV0IHRyYW5zaXRpb25Nb2RlbCBvZiB0aGlzLndvcmtmbG93VHlwZS50cmFuc2l0aW9ucykge1xyXG4gICAgICAgICAgICBjb25zdCBzb3VyY2VFbmRwb2ludFV1aWQ6IHN0cmluZyA9IGAke3RyYW5zaXRpb25Nb2RlbC5zb3VyY2VBY3Rpdml0eUlkfS0ke3RyYW5zaXRpb25Nb2RlbC5zb3VyY2VPdXRjb21lTmFtZX1gO1xyXG4gICAgICAgICAgICBjb25zdCBzb3VyY2VFbmRwb2ludDogRW5kcG9pbnQgPSBwbHVtYmVyLmdldEVuZHBvaW50KHNvdXJjZUVuZHBvaW50VXVpZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uRWxlbWVudElkOiBzdHJpbmcgPSBgYWN0aXZpdHktJHt3b3JrZmxvd0lkfS0ke3RyYW5zaXRpb25Nb2RlbC5kZXN0aW5hdGlvbkFjdGl2aXR5SWR9YDtcclxuXHJcbiAgICAgICAgICAgIHBsdW1iZXIuY29ubmVjdCh7XHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6IHNvdXJjZUVuZHBvaW50LFxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBkZXN0aW5hdGlvbkVsZW1lbnRJZFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIHVwZGF0ZUNhbnZhc0hlaWdodCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zdCAkY29udGFpbmVyID0gJCh0aGlzLmNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgIC8vIEdldCB0aGUgYWN0aXZpdHkgZWxlbWVudCB3aXRoIHRoZSBoaWdoZXN0IFkgY29vcmRpbmF0ZS5cclxuICAgICAgICBjb25zdCAkYWN0aXZpdHlFbGVtZW50cyA9ICRjb250YWluZXIuZmluZChcIi5hY3Rpdml0eVwiKTtcclxuICAgICAgICBsZXQgY3VycmVudEVsZW1lbnRUb3AgPSAwO1xyXG4gICAgICAgIGxldCBjdXJyZW50QWN0aXZpdHlIZWlnaHQgPSAwO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBhY3Rpdml0eUVsZW1lbnQgb2YgJGFjdGl2aXR5RWxlbWVudHMudG9BcnJheSgpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0ICRhY3Rpdml0eUVsZW1lbnQgPSAkKGFjdGl2aXR5RWxlbWVudCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvcCA9ICRhY3Rpdml0eUVsZW1lbnQucG9zaXRpb24oKS50b3A7XHJcblxyXG4gICAgICAgICAgICBpZiAodG9wID4gY3VycmVudEVsZW1lbnRUb3ApIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50VG9wID0gdG9wO1xyXG4gICAgICAgICAgICAgICAgY3VycmVudEFjdGl2aXR5SGVpZ2h0ID0gJGFjdGl2aXR5RWxlbWVudC5oZWlnaHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IG5ld0NhbnZhc0hlaWdodCA9IGN1cnJlbnRFbGVtZW50VG9wICsgY3VycmVudEFjdGl2aXR5SGVpZ2h0O1xyXG4gICAgICAgIGNvbnN0IGVsZW1lbnRCb3R0b20gPSBjdXJyZW50RWxlbWVudFRvcCArIGN1cnJlbnRBY3Rpdml0eUhlaWdodDtcclxuICAgICAgICBjb25zdCBzdHJldGNoVmFsdWUgPSAxMDA7XHJcblxyXG4gICAgICAgIGlmIChuZXdDYW52YXNIZWlnaHQgLSBlbGVtZW50Qm90dG9tIDw9IHN0cmV0Y2hWYWx1ZSkge1xyXG4gICAgICAgICAgICBuZXdDYW52YXNIZWlnaHQgKz0gc3RyZXRjaFZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGNvbnRhaW5lci5oZWlnaHQoTWF0aC5tYXgodGhpcy5taW5DYW52YXNIZWlnaHQsIG5ld0NhbnZhc0hlaWdodCkpO1xyXG4gICAgfTtcclxufVxyXG4iLCIvLy88cmVmZXJlbmNlIHBhdGg9Jy4uL0xpYi9qcXVlcnkvdHlwaW5ncy5kLnRzJyAvPlxuLy8vPHJlZmVyZW5jZSBwYXRoPScuLi9MaWIvanNwbHVtYi90eXBpbmdzLmQudHMnIC8+XG4vLy88cmVmZXJlbmNlIHBhdGg9Jy4vd29ya2Zsb3ctbW9kZWxzLnRzJyAvPlxudmFyIFdvcmtmbG93Q2FudmFzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFdvcmtmbG93Q2FudmFzKGNvbnRhaW5lciwgd29ya2Zsb3dUeXBlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgICAgICB0aGlzLndvcmtmbG93VHlwZSA9IHdvcmtmbG93VHlwZTtcbiAgICAgICAgdGhpcy5taW5DYW52YXNIZWlnaHQgPSA0MDA7XG4gICAgICAgIHRoaXMuZ2V0QWN0aXZpdHlFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAkKF90aGlzLmNvbnRhaW5lcikuZmluZCgnLmFjdGl2aXR5Jyk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZ2V0RGVmYXVsdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIEFuY2hvcjogXCJDb250aW51b3VzXCIsXG4gICAgICAgICAgICAgICAgRHJhZ09wdGlvbnM6IHsgY3Vyc29yOiAncG9pbnRlcicsIHpJbmRleDogMjAwMCB9LFxuICAgICAgICAgICAgICAgIEVuZHBvaW50U3R5bGVzOiBbeyBmaWxsU3R5bGU6ICcjMjI1NTg4JyB9XSxcbiAgICAgICAgICAgICAgICBFbmRwb2ludHM6IFtbXCJEb3RcIiwgeyByYWRpdXM6IDcgfV0sIFtcIkJsYW5rXCJdXSxcbiAgICAgICAgICAgICAgICBDb25uZWN0aW9uT3ZlcmxheXM6IFtcbiAgICAgICAgICAgICAgICAgICAgW1wiQXJyb3dcIiwgeyB3aWR0aDogMTIsIGxlbmd0aDogMTIsIGxvY2F0aW9uOiAtNSB9XSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIENvbm5lY3RvclpJbmRleDogNVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5jcmVhdGVKc1BsdW1iSW5zdGFuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4ganNQbHVtYi5nZXRJbnN0YW5jZSh7XG4gICAgICAgICAgICAgICAgRHJhZ09wdGlvbnM6IHsgY3Vyc29yOiAncG9pbnRlcicsIHpJbmRleDogMjAwMCB9LFxuICAgICAgICAgICAgICAgIENvbm5lY3Rpb25PdmVybGF5czogW1xuICAgICAgICAgICAgICAgICAgICBbJ0Fycm93Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDExLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMTFcbiAgICAgICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgICAgICBbJ0xhYmVsJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiAwLjUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICdsYWJlbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3NzQ2xhc3M6ICdjb25uZWN0aW9uLWxhYmVsJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIENvbnRhaW5lcjogX3RoaXMuY29udGFpbmVyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5nZXRFbmRwb2ludENvbG9yID0gZnVuY3Rpb24gKGFjdGl2aXR5KSB7XG4gICAgICAgICAgICByZXR1cm4gYWN0aXZpdHkuaXNCbG9ja2luZyB8fCBhY3Rpdml0eS5pc1N0YXJ0ID8gJyM3YWIwMmMnIDogYWN0aXZpdHkuaXNFdmVudCA/ICcjM2E4YWNkJyA6ICcjN2FiMDJjJztcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5nZXRTb3VyY2VFbmRwb2ludE9wdGlvbnMgPSBmdW5jdGlvbiAoYWN0aXZpdHksIG91dGNvbWUpIHtcbiAgICAgICAgICAgIC8vIFRoZSBkZWZpbml0aW9uIG9mIHNvdXJjZSBlbmRwb2ludHMuXG4gICAgICAgICAgICB2YXIgcGFpbnRDb2xvciA9IF90aGlzLmdldEVuZHBvaW50Q29sb3IoYWN0aXZpdHkpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBlbmRwb2ludDogJ0RvdCcsXG4gICAgICAgICAgICAgICAgYW5jaG9yOiAnQ29udGludW91cycsXG4gICAgICAgICAgICAgICAgcGFpbnRTdHlsZToge1xuICAgICAgICAgICAgICAgICAgICBzdHJva2U6IHBhaW50Q29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGZpbGw6IHBhaW50Q29sb3IsXG4gICAgICAgICAgICAgICAgICAgIHJhZGl1czogNyxcbiAgICAgICAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGlzU291cmNlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbm5lY3RvcjogWydGbG93Y2hhcnQnLCB7IHN0dWI6IFs0MCwgNjBdLCBnYXA6IDAsIGNvcm5lclJhZGl1czogNSwgYWx3YXlzUmVzcGVjdFN0dWJzOiB0cnVlIH1dLFxuICAgICAgICAgICAgICAgIGNvbm5lY3RvclN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZVdpZHRoOiAyLFxuICAgICAgICAgICAgICAgICAgICBzdHJva2U6ICcjOTk5OTk5JyxcbiAgICAgICAgICAgICAgICAgICAgam9pbnN0eWxlOiAncm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBvdXRsaW5lU3Ryb2tlOiAnd2hpdGUnLFxuICAgICAgICAgICAgICAgICAgICBvdXRsaW5lV2lkdGg6IDJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhvdmVyUGFpbnRTdHlsZToge1xuICAgICAgICAgICAgICAgICAgICBmaWxsOiAnIzIxNjQ3NycsXG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZTogJyMyMTY0NzcnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb25uZWN0b3JIb3ZlclN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZVdpZHRoOiAzLFxuICAgICAgICAgICAgICAgICAgICBzdHJva2U6ICcjMjE2NDc3JyxcbiAgICAgICAgICAgICAgICAgICAgb3V0bGluZVdpZHRoOiA1LFxuICAgICAgICAgICAgICAgICAgICBvdXRsaW5lU3Ryb2tlOiAnd2hpdGUnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb25uZWN0b3JPdmVybGF5czogW1snTGFiZWwnLCB7IGxvY2F0aW9uOiBbMywgLTEuNV0sIGNzc0NsYXNzOiAnZW5kcG9pbnRTb3VyY2VMYWJlbCcgfV1dLFxuICAgICAgICAgICAgICAgIGRyYWdPcHRpb25zOiB7fSxcbiAgICAgICAgICAgICAgICB1dWlkOiBcIlwiLmNvbmNhdChhY3Rpdml0eS5pZCwgXCItXCIpLmNvbmNhdChvdXRjb21lLm5hbWUpLFxuICAgICAgICAgICAgICAgIHBhcmFtZXRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgb3V0Y29tZTogb3V0Y29tZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZ2V0QWN0aXZpdHkgPSBmdW5jdGlvbiAoaWQsIGFjdGl2aXRpZXMpIHtcbiAgICAgICAgICAgIGlmIChhY3Rpdml0aWVzID09PSB2b2lkIDApIHsgYWN0aXZpdGllcyA9IG51bGw7IH1cbiAgICAgICAgICAgIGlmICghYWN0aXZpdGllcykge1xuICAgICAgICAgICAgICAgIGFjdGl2aXRpZXMgPSB0aGlzLndvcmtmbG93VHlwZS5hY3Rpdml0aWVzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICQuZ3JlcChhY3Rpdml0aWVzLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5pZCA9PT0gaWQ7IH0pWzBdO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnVwZGF0ZUNvbm5lY3Rpb25zID0gZnVuY3Rpb24gKHBsdW1iZXIpIHtcbiAgICAgICAgICAgIHZhciB3b3JrZmxvd0lkID0gX3RoaXMud29ya2Zsb3dUeXBlLmlkO1xuICAgICAgICAgICAgLy8gQ29ubmVjdCBhY3Rpdml0aWVzLlxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IF90aGlzLndvcmtmbG93VHlwZS50cmFuc2l0aW9uczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdHJhbnNpdGlvbk1vZGVsID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VFbmRwb2ludFV1aWQgPSBcIlwiLmNvbmNhdCh0cmFuc2l0aW9uTW9kZWwuc291cmNlQWN0aXZpdHlJZCwgXCItXCIpLmNvbmNhdCh0cmFuc2l0aW9uTW9kZWwuc291cmNlT3V0Y29tZU5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VFbmRwb2ludCA9IHBsdW1iZXIuZ2V0RW5kcG9pbnQoc291cmNlRW5kcG9pbnRVdWlkKTtcbiAgICAgICAgICAgICAgICB2YXIgZGVzdGluYXRpb25FbGVtZW50SWQgPSBcImFjdGl2aXR5LVwiLmNvbmNhdCh3b3JrZmxvd0lkLCBcIi1cIikuY29uY2F0KHRyYW5zaXRpb25Nb2RlbC5kZXN0aW5hdGlvbkFjdGl2aXR5SWQpO1xuICAgICAgICAgICAgICAgIHBsdW1iZXIuY29ubmVjdCh7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogc291cmNlRW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogZGVzdGluYXRpb25FbGVtZW50SWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy51cGRhdGVDYW52YXNIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgJGNvbnRhaW5lciA9ICQodGhpcy5jb250YWluZXIpO1xuICAgICAgICAgICAgLy8gR2V0IHRoZSBhY3Rpdml0eSBlbGVtZW50IHdpdGggdGhlIGhpZ2hlc3QgWSBjb29yZGluYXRlLlxuICAgICAgICAgICAgdmFyICRhY3Rpdml0eUVsZW1lbnRzID0gJGNvbnRhaW5lci5maW5kKFwiLmFjdGl2aXR5XCIpO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRFbGVtZW50VG9wID0gMDtcbiAgICAgICAgICAgIHZhciBjdXJyZW50QWN0aXZpdHlIZWlnaHQgPSAwO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9ICRhY3Rpdml0eUVsZW1lbnRzLnRvQXJyYXkoKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlFbGVtZW50ID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgIHZhciAkYWN0aXZpdHlFbGVtZW50ID0gJChhY3Rpdml0eUVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHZhciB0b3BfMSA9ICRhY3Rpdml0eUVsZW1lbnQucG9zaXRpb24oKS50b3A7XG4gICAgICAgICAgICAgICAgaWYgKHRvcF8xID4gY3VycmVudEVsZW1lbnRUb3ApIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEVsZW1lbnRUb3AgPSB0b3BfMTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEFjdGl2aXR5SGVpZ2h0ID0gJGFjdGl2aXR5RWxlbWVudC5oZWlnaHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbmV3Q2FudmFzSGVpZ2h0ID0gY3VycmVudEVsZW1lbnRUb3AgKyBjdXJyZW50QWN0aXZpdHlIZWlnaHQ7XG4gICAgICAgICAgICB2YXIgZWxlbWVudEJvdHRvbSA9IGN1cnJlbnRFbGVtZW50VG9wICsgY3VycmVudEFjdGl2aXR5SGVpZ2h0O1xuICAgICAgICAgICAgdmFyIHN0cmV0Y2hWYWx1ZSA9IDEwMDtcbiAgICAgICAgICAgIGlmIChuZXdDYW52YXNIZWlnaHQgLSBlbGVtZW50Qm90dG9tIDw9IHN0cmV0Y2hWYWx1ZSkge1xuICAgICAgICAgICAgICAgIG5ld0NhbnZhc0hlaWdodCArPSBzdHJldGNoVmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkY29udGFpbmVyLmhlaWdodChNYXRoLm1heCh0aGlzLm1pbkNhbnZhc0hlaWdodCwgbmV3Q2FudmFzSGVpZ2h0KSk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBXb3JrZmxvd0NhbnZhcztcbn0oKSk7XG4iLCIvLy88cmVmZXJlbmNlIHBhdGg9Jy4uL0xpYi9qcXVlcnkvdHlwaW5ncy5kLnRzJyAvPlxyXG4vLy88cmVmZXJlbmNlIHBhdGg9Jy4uL0xpYi9qc3BsdW1iL3R5cGluZ3MuZC50cycgLz5cclxuLy8vPHJlZmVyZW5jZSBwYXRoPScuL3dvcmtmbG93LW1vZGVscy50cycgLz5cclxuLy8vPHJlZmVyZW5jZSBwYXRoPScuL3dvcmtmbG93LWNhbnZhcy50cycgLz5cclxuXHJcbi8vIFRPRE86IFJlLWltcGxlbWVudCB0aGlzIHVzaW5nIGEgTVZWTSBhcHByb2FjaC5cclxuY2xhc3MgV29ya2Zsb3dFZGl0b3IgZXh0ZW5kcyBXb3JrZmxvd0NhbnZhcyB7XHJcbiAgICBwcml2YXRlIGpzUGx1bWJJbnN0YW5jZToganNQbHVtYkluc3RhbmNlO1xyXG4gICAgcHJpdmF0ZSBpc1BvcG92ZXJWaXNpYmxlOiBib29sZWFuO1xyXG4gICAgcHJpdmF0ZSBoYXNEcmFnZ2VkOiBib29sZWFuO1xyXG4gICAgcHJpdmF0ZSBkcmFnU3RhcnQ6IEpRdWVyeS5Db29yZGluYXRlcztcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcHJvdGVjdGVkIHdvcmtmbG93VHlwZTogV29ya2Zsb3dzLldvcmtmbG93VHlwZSwgcHJpdmF0ZSBkZWxldGVBY3Rpdml0eVByb21wdDogc3RyaW5nLCBwcml2YXRlIGxvY2FsSWQ6IHN0cmluZywgbG9hZExvY2FsU3RhdGU6IGJvb2xlYW4pIHtcclxuICAgICAgICBzdXBlcihjb250YWluZXIsIHdvcmtmbG93VHlwZSk7XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgIGpzUGx1bWIucmVhZHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBqc1BsdW1iLmltcG9ydERlZmF1bHRzKHRoaXMuZ2V0RGVmYXVsdHMoKSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwbHVtYmVyID0gdGhpcy5jcmVhdGVKc1BsdW1iSW5zdGFuY2UoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIExpc3RlbiBmb3IgbmV3IGNvbm5lY3Rpb25zLlxyXG4gICAgICAgICAgICBwbHVtYmVyLmJpbmQoJ2Nvbm5lY3Rpb24nLCBmdW5jdGlvbiAoY29ubkluZm8sIG9yaWdpbmFsRXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb246IENvbm5lY3Rpb24gPSBjb25uSW5mby5jb25uZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgb3V0Y29tZTogV29ya2Zsb3dzLk91dGNvbWUgPSBjb25uZWN0aW9uLmdldFBhcmFtZXRlcnMoKS5vdXRjb21lO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGxhYmVsOiBhbnkgPSBjb25uZWN0aW9uLmdldE92ZXJsYXkoJ2xhYmVsJyk7XHJcbiAgICAgICAgICAgICAgICBsYWJlbC5zZXRMYWJlbChvdXRjb21lLmRpc3BsYXlOYW1lKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgYWN0aXZpdHlFbGVtZW50cyA9IHRoaXMuZ2V0QWN0aXZpdHlFbGVtZW50cygpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGFyZUVxdWFsT3V0Y29tZXMgPSBmdW5jdGlvbiAob3V0Y29tZXMxOiBXb3JrZmxvd3MuT3V0Y29tZVtdLCBvdXRjb21lczI6IFdvcmtmbG93cy5PdXRjb21lW10pOiBib29sZWFuIHtcclxuICAgICAgICAgICAgICAgIGlmIChvdXRjb21lczEubGVuZ3RoICE9IG91dGNvbWVzMi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvdXRjb21lczEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRjb21lMSA9IG91dGNvbWVzMVtpXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRjb21lMiA9IG91dGNvbWVzMltpXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG91dGNvbWUxLm5hbWUgIT0gb3V0Y29tZTIuZGlzcGxheU5hbWUgfHwgb3V0Y29tZTEuZGlzcGxheU5hbWUgIT0gb3V0Y29tZTIuZGlzcGxheU5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gU3VzcGVuZCBkcmF3aW5nIGFuZCBpbml0aWFsaXplLlxyXG4gICAgICAgICAgICBwbHVtYmVyLmJhdGNoKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHZhciBzZXJ2ZXJ3b3JrZmxvd1R5cGU6IFdvcmtmbG93cy5Xb3JrZmxvd1R5cGUgPSB0aGlzLndvcmtmbG93VHlwZTtcclxuICAgICAgICAgICAgICAgIHZhciB3b3JrZmxvd0lkOiBudW1iZXIgPSB0aGlzLndvcmtmbG93VHlwZS5pZDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobG9hZExvY2FsU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsb2NhbFN0YXRlOiBXb3JrZmxvd3MuV29ya2Zsb3dUeXBlID0gdGhpcy5sb2FkTG9jYWxTdGF0ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAobG9jYWxTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndvcmtmbG93VHlwZSA9IGxvY2FsU3RhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHMuZWFjaCgoXywgYWN0aXZpdHlFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgJGFjdGl2aXR5RWxlbWVudCA9ICQoYWN0aXZpdHlFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3Rpdml0eUlkID0gJGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1pZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzRGVsZXRlZCA9IHRoaXMud29ya2Zsb3dUeXBlLnJlbW92ZWRBY3Rpdml0aWVzLmluZGV4T2YoYWN0aXZpdHlJZCkgPiAtMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRGVsZXRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYWN0aXZpdHlFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZpdHkgPSB0aGlzLmdldEFjdGl2aXR5KGFjdGl2aXR5SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlcnZlckFjdGl2aXR5ID0gdGhpcy5nZXRBY3Rpdml0eShhY3Rpdml0eUlkLCBzZXJ2ZXJ3b3JrZmxvd1R5cGUuYWN0aXZpdGllcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgYWN0aXZpdHkncyB2aXN1YWwgc3RhdGUuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRMb2NhbFN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0eSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgbmV3bHkgYWRkZWQgYWN0aXZpdHkgbm90IHlldCBhZGRlZCB0byBsb2NhbCBzdGF0ZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5ID0gc2VydmVyQWN0aXZpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndvcmtmbG93VHlwZS5hY3Rpdml0aWVzLnB1c2goYWN0aXZpdHkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5LnggPSA1MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5LnkgPSA1MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBhdmFpbGFibGUgb3V0Y29tZXMgbWlnaHQgaGF2ZSBjaGFuZ2VkIHdoZW4gZWRpdGluZyBhbiBhY3Rpdml0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvIHdlIG5lZWQgdG8gY2hlY2sgZm9yIHRoYXQgYW5kIHVwZGF0ZSB0aGUgY2xpZW50J3MgYWN0aXZpdHkgb3V0Y29tZXMgaWYgc28uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzYW1lT3V0Y29tZXMgPSBhcmVFcXVhbE91dGNvbWVzKGFjdGl2aXR5Lm91dGNvbWVzLCBzZXJ2ZXJBY3Rpdml0eS5vdXRjb21lcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzYW1lT3V0Y29tZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eS5vdXRjb21lcyA9IHNlcnZlckFjdGl2aXR5Lm91dGNvbWVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpdml0eUVsZW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3NzKHsgbGVmdDogYWN0aXZpdHkueCwgdG9wOiBhY3Rpdml0eS55IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvZ2dsZUNsYXNzKCdhY3Rpdml0eS1zdGFydCcsIGFjdGl2aXR5LmlzU3RhcnQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JywgYWN0aXZpdHkuaXNTdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgdGhlIGFjdGl2aXR5IGRyYWdnYWJsZS5cclxuICAgICAgICAgICAgICAgICAgICBwbHVtYmVyLmRyYWdnYWJsZShhY3Rpdml0eUVsZW1lbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JpZDogWzEwLCAxMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5tZW50OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogKGFyZ3M6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmFnU3RhcnQgPSB7IGxlZnQ6IGFyZ3MuZS5zY3JlZW5YLCB0b3A6IGFyZ3MuZS5zY3JlZW5ZIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3A6IChhcmdzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzRHJhZ2dlZCA9IHRoaXMuZHJhZ1N0YXJ0LmxlZnQgIT0gYXJncy5lLnNjcmVlblggfHwgdGhpcy5kcmFnU3RhcnQudG9wICE9IGFyZ3MuZS5zY3JlZW5ZO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBDb25maWd1cmUgdGhlIGFjdGl2aXR5IGFzIGEgdGFyZ2V0LlxyXG4gICAgICAgICAgICAgICAgICAgIHBsdW1iZXIubWFrZVRhcmdldChhY3Rpdml0eUVsZW1lbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZHJvcE9wdGlvbnM6IHsgaG92ZXJDbGFzczogJ2hvdmVyJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6ICdDb250aW51b3VzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6IFsnQmxhbmsnLCB7IHJhZGl1czogOCB9XVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgc291cmNlIGVuZHBvaW50cy5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBvdXRjb21lIG9mIGFjdGl2aXR5Lm91dGNvbWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZUVuZHBvaW50T3B0aW9ucyA9IHRoaXMuZ2V0U291cmNlRW5kcG9pbnRPcHRpb25zKGFjdGl2aXR5LCBvdXRjb21lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1bWJlci5hZGRFbmRwb2ludChhY3Rpdml0eUVsZW1lbnQsIHsgY29ubmVjdG9yT3ZlcmxheXM6IFtbJ0xhYmVsJywgeyBsYWJlbDogb3V0Y29tZS5kaXNwbGF5TmFtZSwgY3NzQ2xhc3M6ICdjb25uZWN0aW9uLWxhYmVsJyB9XV0gfSwgc291cmNlRW5kcG9pbnRPcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDb25uZWN0IGFjdGl2aXRpZXMuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbm5lY3Rpb25zKHBsdW1iZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFJlLXF1ZXJ5IHRoZSBhY3Rpdml0eSBlbGVtZW50cy5cclxuICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHMgPSB0aGlzLmdldEFjdGl2aXR5RWxlbWVudHMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBNYWtlIGFsbCBhY3Rpdml0eSBlbGVtZW50cyB2aXNpYmxlLlxyXG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5zaG93KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIHBvcG92ZXJzLlxyXG4gICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzLmVhY2goKF8sIGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eUVsZW1lbnQgPSAkKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50LnBvcG92ZXIoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdtYW51YWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGh0bWw6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkY29udGVudDogSlF1ZXJ5PEVsZW1lbnQ+ID0gYWN0aXZpdHlFbGVtZW50LmZpbmQoJy5hY3Rpdml0eS1jb21tYW5kcycpLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0QnV0dG9uID0gJGNvbnRlbnQuZmluZCgnLmFjdGl2aXR5LXN0YXJ0LWFjdGlvbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1N0YXJ0ID0gYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JykgPT09IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2aXR5SWQ6IG51bWJlciA9IGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1pZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydEJ1dHRvbi5hdHRyKCdhcmlhLXByZXNzZWQnLCBhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktc3RhcnQnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0QnV0dG9uLnRvZ2dsZUNsYXNzKCdhY3RpdmUnLCBpc1N0YXJ0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb250ZW50Lm9uKCdjbGljaycsICcuYWN0aXZpdHktc3RhcnQtYWN0aW9uJywgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSAkKGUuY3VycmVudFRhcmdldCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNTdGFydCA9IGJ1dHRvbi5pcygnLmFjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JywgaXNTdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnQudG9nZ2xlQ2xhc3MoJ2FjdGl2aXR5LXN0YXJ0JywgaXNTdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgJGNvbnRlbnQub24oJ2NsaWNrJywgJy5hY3Rpdml0eS1kZWxldGUtYWN0aW9uJywgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogVGhlIHByb21wdHMgYXJlIHJlYWxseSBhbm5veWluZy4gQ29uc2lkZXIgc2hvd2luZyBzb21lIHNvcnQgb2Ygc21hbGwgbWVzc2FnZSBiYWxsb29uIHNvbWV3aGVyZSB0byB1bmRvIHRoZSBhY3Rpb24gaW5zdGVhZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgKCFjb25maXJtKHNlbGYuZGVsZXRlQWN0aXZpdHlQcm9tcHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL31cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLndvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllcy5wdXNoKGFjdGl2aXR5SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1bWJlci5yZW1vdmUoYWN0aXZpdHlFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudC5wb3BvdmVyKCdkaXNwb3NlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgJGNvbnRlbnQub24oJ2NsaWNrJywgJ1tkYXRhLXBlcnNpc3Qtd29ya2Zsb3ddJywgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNhdmVMb2NhbFN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRjb250ZW50LmdldCgwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgICQoY29udGFpbmVyKS5vbignY2xpY2snLCAnLmFjdGl2aXR5JywgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNEcmFnZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNEcmFnZ2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGlmIGFueSBvdGhlciBwb3BvdmVycyBhcmUgdmlzaWJsZSwgaGlkZSB0aGVtXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1BvcG92ZXJWaXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5wb3BvdmVyKCdoaWRlJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VuZGVyID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgc2VuZGVyLnBvcG92ZXIoJ3Nob3cnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgY2xpY2tpbmcgb24gdGhlIHBvcG92ZXIgaXRzZWxmLlxyXG4gICAgICAgICAgICAgICAgJCgnLnBvcG92ZXInKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgZTIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGUyLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1BvcG92ZXJWaXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkKGNvbnRhaW5lcikub24oJ2RibGNsaWNrJywgJy5hY3Rpdml0eScsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VuZGVyID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaGFzRWRpdG9yID0gc2VuZGVyLmRhdGEoJ2FjdGl2aXR5LWhhcy1lZGl0b3InKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaGFzRWRpdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlTG9jYWxTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbmRlci5maW5kKCcuYWN0aXZpdHktZWRpdC1hY3Rpb24nKS5nZXQoMCkuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBIaWRlIGFsbCBwb3BvdmVycyB3aGVuIGNsaWNraW5nIGFueXdoZXJlIGJ1dCBvbiBhbiBhY3Rpdml0eS5cclxuICAgICAgICAgICAgJCgnYm9keScpLm9uKCdjbGljaycsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5wb3BvdmVyKCdoaWRlJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzUG9wb3ZlclZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBTYXZlIGxvY2FsIGNoYW5nZXMgaWYgdGhlIGV2ZW50IHRhcmdldCBoYXMgdGhlICdkYXRhLXBlcnNpc3Qtd29ya2Zsb3cnIGF0dHJpYnV0ZS5cclxuICAgICAgICAgICAgJCgnYm9keScpLm9uKCdjbGljaycsICdbZGF0YS1wZXJzaXN0LXdvcmtmbG93XScsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlTG9jYWxTdGF0ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuanNQbHVtYkluc3RhbmNlID0gcGx1bWJlcjtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFN0YXRlID0gKCk6IFdvcmtmbG93cy5Xb3JrZmxvd1R5cGUgPT4ge1xyXG4gICAgICAgIGNvbnN0ICRhbGxBY3Rpdml0eUVsZW1lbnRzID0gJCh0aGlzLmNvbnRhaW5lcikuZmluZCgnLmFjdGl2aXR5Jyk7XHJcbiAgICAgICAgY29uc3Qgd29ya2Zsb3c6IFdvcmtmbG93cy5Xb3JrZmxvd1R5cGUgPSB7XHJcbiAgICAgICAgICAgIGlkOiB0aGlzLndvcmtmbG93VHlwZS5pZCxcclxuICAgICAgICAgICAgYWN0aXZpdGllczogW10sXHJcbiAgICAgICAgICAgIHRyYW5zaXRpb25zOiBbXSxcclxuICAgICAgICAgICAgcmVtb3ZlZEFjdGl2aXRpZXM6IHRoaXMud29ya2Zsb3dUeXBlLnJlbW92ZWRBY3Rpdml0aWVzXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gQ29sbGVjdCBhY3Rpdml0aWVzLlxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgJGFsbEFjdGl2aXR5RWxlbWVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgJGFjdGl2aXR5RWxlbWVudDogSlF1ZXJ5ID0gJCgkYWxsQWN0aXZpdHlFbGVtZW50c1tpXSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2aXR5SWQ6IHN0cmluZyA9ICRhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktaWQnKTtcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZpdHlJc1N0YXJ0OiBib29sZWFuID0gJGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1zdGFydCcpO1xyXG4gICAgICAgICAgICBjb25zdCBhY3Rpdml0eUlzRXZlbnQ6IGJvb2xlYW4gPSAkYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXR5cGUnKSA9PT0gJ0V2ZW50JztcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZpdHlQb3NpdGlvbjogSlF1ZXJ5LkNvb3JkaW5hdGVzID0gJGFjdGl2aXR5RWxlbWVudC5wb3NpdGlvbigpO1xyXG4gICAgICAgICAgICBjb25zdCBhY3Rpdml0eTogV29ya2Zsb3dzLkFjdGl2aXR5ID0gdGhpcy5nZXRBY3Rpdml0eShhY3Rpdml0eUlkKTtcclxuXHJcbiAgICAgICAgICAgIHdvcmtmbG93LmFjdGl2aXRpZXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBpZDogYWN0aXZpdHlJZCxcclxuICAgICAgICAgICAgICAgIGlzU3RhcnQ6IGFjdGl2aXR5SXNTdGFydCxcclxuICAgICAgICAgICAgICAgIGlzRXZlbnQ6IGFjdGl2aXR5SXNFdmVudCxcclxuICAgICAgICAgICAgICAgIG91dGNvbWVzOiBhY3Rpdml0eS5vdXRjb21lcyxcclxuICAgICAgICAgICAgICAgIHg6IGFjdGl2aXR5UG9zaXRpb24ubGVmdCxcclxuICAgICAgICAgICAgICAgIHk6IGFjdGl2aXR5UG9zaXRpb24udG9wXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ29sbGVjdCBjb25uZWN0aW9ucy5cclxuICAgICAgICBjb25zdCBhbGxDb25uZWN0aW9ucyA9IHRoaXMuanNQbHVtYkluc3RhbmNlLmdldENvbm5lY3Rpb25zKCk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsQ29ubmVjdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBhbGxDb25uZWN0aW9uc1tpXTtcclxuICAgICAgICAgICAgdmFyIHNvdXJjZUVuZHBvaW50OiBFbmRwb2ludCA9IGNvbm5lY3Rpb24uZW5kcG9pbnRzWzBdO1xyXG4gICAgICAgICAgICB2YXIgc291cmNlT3V0Y29tZU5hbWUgPSBzb3VyY2VFbmRwb2ludC5nZXRQYXJhbWV0ZXJzKCkub3V0Y29tZS5uYW1lO1xyXG4gICAgICAgICAgICB2YXIgc291cmNlQWN0aXZpdHlJZDogc3RyaW5nID0gJChjb25uZWN0aW9uLnNvdXJjZSkuZGF0YSgnYWN0aXZpdHktaWQnKTtcclxuICAgICAgICAgICAgdmFyIGRlc3RpbmF0aW9uQWN0aXZpdHlJZDogc3RyaW5nID0gJChjb25uZWN0aW9uLnRhcmdldCkuZGF0YSgnYWN0aXZpdHktaWQnKTtcclxuXHJcbiAgICAgICAgICAgIHdvcmtmbG93LnRyYW5zaXRpb25zLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgc291cmNlQWN0aXZpdHlJZDogc291cmNlQWN0aXZpdHlJZCxcclxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uQWN0aXZpdHlJZDogZGVzdGluYXRpb25BY3Rpdml0eUlkLFxyXG4gICAgICAgICAgICAgICAgc291cmNlT3V0Y29tZU5hbWU6IHNvdXJjZU91dGNvbWVOYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHdvcmtmbG93O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXJpYWxpemUgPSAoKTogc3RyaW5nID0+IHtcclxuICAgICAgICBjb25zdCB3b3JrZmxvdzogV29ya2Zsb3dzLldvcmtmbG93VHlwZSA9IHRoaXMuZ2V0U3RhdGUoKTtcclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkod29ya2Zsb3cpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2F2ZUxvY2FsU3RhdGUgPSAoKTogdm9pZCA9PiB7XHJcbiAgICAgICAgc2Vzc2lvblN0b3JhZ2VbdGhpcy5sb2NhbElkXSA9IHRoaXMuc2VyaWFsaXplKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBsb2FkTG9jYWxTdGF0ZSA9ICgpOiBXb3JrZmxvd3MuV29ya2Zsb3dUeXBlID0+IHtcclxuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZVt0aGlzLmxvY2FsSWRdKTtcclxuICAgIH1cclxufVxyXG5cclxuJC5mbi53b3JrZmxvd0VkaXRvciA9IGZ1bmN0aW9uICh0aGlzOiBKUXVlcnkpOiBKUXVlcnkge1xyXG4gICAgdGhpcy5lYWNoKChpbmRleCwgZWxlbWVudCkgPT4ge1xyXG4gICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7XHJcbiAgICAgICAgdmFyIHdvcmtmbG93VHlwZTogV29ya2Zsb3dzLldvcmtmbG93VHlwZSA9ICRlbGVtZW50LmRhdGEoJ3dvcmtmbG93LXR5cGUnKTtcclxuICAgICAgICB2YXIgZGVsZXRlQWN0aXZpdHlQcm9tcHQ6IHN0cmluZyA9ICRlbGVtZW50LmRhdGEoJ3dvcmtmbG93LWRlbGV0ZS1hY3Rpdml0eS1wcm9tcHQnKTtcclxuICAgICAgICB2YXIgbG9jYWxJZDogc3RyaW5nID0gJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3ctbG9jYWwtaWQnKTtcclxuICAgICAgICB2YXIgbG9hZExvY2FsU3RhdGU6IGJvb2xlYW4gPSAkZWxlbWVudC5kYXRhKCd3b3JrZmxvdy1sb2FkLWxvY2FsLXN0YXRlJyk7XHJcblxyXG4gICAgICAgIHdvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllcyA9IHdvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllcyB8fCBbXTtcclxuICAgICAgICAkZWxlbWVudC5kYXRhKCd3b3JrZmxvd0VkaXRvcicsIG5ldyBXb3JrZmxvd0VkaXRvcihlbGVtZW50LCB3b3JrZmxvd1R5cGUsIGRlbGV0ZUFjdGl2aXR5UHJvbXB0LCBsb2NhbElkLCBsb2FkTG9jYWxTdGF0ZSkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn07XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCB3b3JrZmxvd0VkaXRvcjogV29ya2Zsb3dFZGl0b3IgPSAkKCcud29ya2Zsb3ctY2FudmFzJykud29ya2Zsb3dFZGl0b3IoKS5kYXRhKCd3b3JrZmxvd0VkaXRvcicpO1xyXG5cclxuICAgICQoJyN3b3JrZmxvd0VkaXRvckZvcm0nKS5vbignc3VibWl0JywgKHMsIGUpID0+IHtcclxuICAgICAgICBjb25zdCBzdGF0ZSA9IHdvcmtmbG93RWRpdG9yLnNlcmlhbGl6ZSgpO1xyXG4gICAgICAgICQoJyN3b3JrZmxvd1N0YXRlSW5wdXQnKS52YWwoc3RhdGUpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iLCIvLy88cmVmZXJlbmNlIHBhdGg9Jy4uL0xpYi9qcXVlcnkvdHlwaW5ncy5kLnRzJyAvPlxuLy8vPHJlZmVyZW5jZSBwYXRoPScuLi9MaWIvanNwbHVtYi90eXBpbmdzLmQudHMnIC8+XG4vLy88cmVmZXJlbmNlIHBhdGg9Jy4vd29ya2Zsb3ctbW9kZWxzLnRzJyAvPlxuLy8vPHJlZmVyZW5jZSBwYXRoPScuL3dvcmtmbG93LWNhbnZhcy50cycgLz5cbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG4vLyBUT0RPOiBSZS1pbXBsZW1lbnQgdGhpcyB1c2luZyBhIE1WVk0gYXBwcm9hY2guXG52YXIgV29ya2Zsb3dFZGl0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFdvcmtmbG93RWRpdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFdvcmtmbG93RWRpdG9yKGNvbnRhaW5lciwgd29ya2Zsb3dUeXBlLCBkZWxldGVBY3Rpdml0eVByb21wdCwgbG9jYWxJZCwgbG9hZExvY2FsU3RhdGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgY29udGFpbmVyLCB3b3JrZmxvd1R5cGUpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgX3RoaXMud29ya2Zsb3dUeXBlID0gd29ya2Zsb3dUeXBlO1xuICAgICAgICBfdGhpcy5kZWxldGVBY3Rpdml0eVByb21wdCA9IGRlbGV0ZUFjdGl2aXR5UHJvbXB0O1xuICAgICAgICBfdGhpcy5sb2NhbElkID0gbG9jYWxJZDtcbiAgICAgICAgX3RoaXMuZ2V0U3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgJGFsbEFjdGl2aXR5RWxlbWVudHMgPSAkKF90aGlzLmNvbnRhaW5lcikuZmluZCgnLmFjdGl2aXR5Jyk7XG4gICAgICAgICAgICB2YXIgd29ya2Zsb3cgPSB7XG4gICAgICAgICAgICAgICAgaWQ6IF90aGlzLndvcmtmbG93VHlwZS5pZCxcbiAgICAgICAgICAgICAgICBhY3Rpdml0aWVzOiBbXSxcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uczogW10sXG4gICAgICAgICAgICAgICAgcmVtb3ZlZEFjdGl2aXRpZXM6IF90aGlzLndvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIENvbGxlY3QgYWN0aXZpdGllcy5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJGFsbEFjdGl2aXR5RWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgJGFjdGl2aXR5RWxlbWVudCA9ICQoJGFsbEFjdGl2aXR5RWxlbWVudHNbaV0pO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eUlkID0gJGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1pZCcpO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eUlzU3RhcnQgPSAkYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0Jyk7XG4gICAgICAgICAgICAgICAgdmFyIGFjdGl2aXR5SXNFdmVudCA9ICRhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktdHlwZScpID09PSAnRXZlbnQnO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eVBvc2l0aW9uID0gJGFjdGl2aXR5RWxlbWVudC5wb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eSA9IF90aGlzLmdldEFjdGl2aXR5KGFjdGl2aXR5SWQpO1xuICAgICAgICAgICAgICAgIHdvcmtmbG93LmFjdGl2aXRpZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBhY3Rpdml0eUlkLFxuICAgICAgICAgICAgICAgICAgICBpc1N0YXJ0OiBhY3Rpdml0eUlzU3RhcnQsXG4gICAgICAgICAgICAgICAgICAgIGlzRXZlbnQ6IGFjdGl2aXR5SXNFdmVudCxcbiAgICAgICAgICAgICAgICAgICAgb3V0Y29tZXM6IGFjdGl2aXR5Lm91dGNvbWVzLFxuICAgICAgICAgICAgICAgICAgICB4OiBhY3Rpdml0eVBvc2l0aW9uLmxlZnQsXG4gICAgICAgICAgICAgICAgICAgIHk6IGFjdGl2aXR5UG9zaXRpb24udG9wXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDb2xsZWN0IGNvbm5lY3Rpb25zLlxuICAgICAgICAgICAgdmFyIGFsbENvbm5lY3Rpb25zID0gX3RoaXMuanNQbHVtYkluc3RhbmNlLmdldENvbm5lY3Rpb25zKCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFsbENvbm5lY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBhbGxDb25uZWN0aW9uc1tpXTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlRW5kcG9pbnQgPSBjb25uZWN0aW9uLmVuZHBvaW50c1swXTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlT3V0Y29tZU5hbWUgPSBzb3VyY2VFbmRwb2ludC5nZXRQYXJhbWV0ZXJzKCkub3V0Y29tZS5uYW1lO1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VBY3Rpdml0eUlkID0gJChjb25uZWN0aW9uLnNvdXJjZSkuZGF0YSgnYWN0aXZpdHktaWQnKTtcbiAgICAgICAgICAgICAgICB2YXIgZGVzdGluYXRpb25BY3Rpdml0eUlkID0gJChjb25uZWN0aW9uLnRhcmdldCkuZGF0YSgnYWN0aXZpdHktaWQnKTtcbiAgICAgICAgICAgICAgICB3b3JrZmxvdy50cmFuc2l0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlQWN0aXZpdHlJZDogc291cmNlQWN0aXZpdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb25BY3Rpdml0eUlkOiBkZXN0aW5hdGlvbkFjdGl2aXR5SWQsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZU91dGNvbWVOYW1lOiBzb3VyY2VPdXRjb21lTmFtZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHdvcmtmbG93O1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5zZXJpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgd29ya2Zsb3cgPSBfdGhpcy5nZXRTdGF0ZSgpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHdvcmtmbG93KTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuc2F2ZUxvY2FsU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZXNzaW9uU3RvcmFnZVtfdGhpcy5sb2NhbElkXSA9IF90aGlzLnNlcmlhbGl6ZSgpO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5sb2FkTG9jYWxTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlW190aGlzLmxvY2FsSWRdKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHNlbGYgPSBfdGhpcztcbiAgICAgICAganNQbHVtYi5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBqc1BsdW1iLmltcG9ydERlZmF1bHRzKF90aGlzLmdldERlZmF1bHRzKCkpO1xuICAgICAgICAgICAgdmFyIHBsdW1iZXIgPSBfdGhpcy5jcmVhdGVKc1BsdW1iSW5zdGFuY2UoKTtcbiAgICAgICAgICAgIC8vIExpc3RlbiBmb3IgbmV3IGNvbm5lY3Rpb25zLlxuICAgICAgICAgICAgcGx1bWJlci5iaW5kKCdjb25uZWN0aW9uJywgZnVuY3Rpb24gKGNvbm5JbmZvLCBvcmlnaW5hbEV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBjb25uSW5mby5jb25uZWN0aW9uO1xuICAgICAgICAgICAgICAgIHZhciBvdXRjb21lID0gY29ubmVjdGlvbi5nZXRQYXJhbWV0ZXJzKCkub3V0Y29tZTtcbiAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBjb25uZWN0aW9uLmdldE92ZXJsYXkoJ2xhYmVsJyk7XG4gICAgICAgICAgICAgICAgbGFiZWwuc2V0TGFiZWwob3V0Y29tZS5kaXNwbGF5TmFtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBhY3Rpdml0eUVsZW1lbnRzID0gX3RoaXMuZ2V0QWN0aXZpdHlFbGVtZW50cygpO1xuICAgICAgICAgICAgdmFyIGFyZUVxdWFsT3V0Y29tZXMgPSBmdW5jdGlvbiAob3V0Y29tZXMxLCBvdXRjb21lczIpIHtcbiAgICAgICAgICAgICAgICBpZiAob3V0Y29tZXMxLmxlbmd0aCAhPSBvdXRjb21lczIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvdXRjb21lczEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG91dGNvbWUxID0gb3V0Y29tZXMxW2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3V0Y29tZTIgPSBvdXRjb21lczJbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChvdXRjb21lMS5uYW1lICE9IG91dGNvbWUyLmRpc3BsYXlOYW1lIHx8IG91dGNvbWUxLmRpc3BsYXlOYW1lICE9IG91dGNvbWUyLmRpc3BsYXlOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gU3VzcGVuZCBkcmF3aW5nIGFuZCBpbml0aWFsaXplLlxuICAgICAgICAgICAgcGx1bWJlci5iYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlcnZlcndvcmtmbG93VHlwZSA9IF90aGlzLndvcmtmbG93VHlwZTtcbiAgICAgICAgICAgICAgICB2YXIgd29ya2Zsb3dJZCA9IF90aGlzLndvcmtmbG93VHlwZS5pZDtcbiAgICAgICAgICAgICAgICBpZiAobG9hZExvY2FsU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsU3RhdGUgPSBfdGhpcy5sb2FkTG9jYWxTdGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9jYWxTdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMud29ya2Zsb3dUeXBlID0gbG9jYWxTdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzLmVhY2goZnVuY3Rpb24gKF8sIGFjdGl2aXR5RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJGFjdGl2aXR5RWxlbWVudCA9ICQoYWN0aXZpdHlFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2aXR5SWQgPSAkYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LWlkJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc0RlbGV0ZWQgPSBfdGhpcy53b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXMuaW5kZXhPZihhY3Rpdml0eUlkKSA+IC0xO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNEZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkYWN0aXZpdHlFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eSA9IF90aGlzLmdldEFjdGl2aXR5KGFjdGl2aXR5SWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VydmVyQWN0aXZpdHkgPSBfdGhpcy5nZXRBY3Rpdml0eShhY3Rpdml0eUlkLCBzZXJ2ZXJ3b3JrZmxvd1R5cGUuYWN0aXZpdGllcyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgYWN0aXZpdHkncyB2aXN1YWwgc3RhdGUuXG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2FkTG9jYWxTdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgbmV3bHkgYWRkZWQgYWN0aXZpdHkgbm90IHlldCBhZGRlZCB0byBsb2NhbCBzdGF0ZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSA9IHNlcnZlckFjdGl2aXR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLndvcmtmbG93VHlwZS5hY3Rpdml0aWVzLnB1c2goYWN0aXZpdHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5LnggPSA1MDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eS55ID0gNTA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgYXZhaWxhYmxlIG91dGNvbWVzIG1pZ2h0IGhhdmUgY2hhbmdlZCB3aGVuIGVkaXRpbmcgYW4gYWN0aXZpdHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gd2UgbmVlZCB0byBjaGVjayBmb3IgdGhhdCBhbmQgdXBkYXRlIHRoZSBjbGllbnQncyBhY3Rpdml0eSBvdXRjb21lcyBpZiBzby5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2FtZU91dGNvbWVzID0gYXJlRXF1YWxPdXRjb21lcyhhY3Rpdml0eS5vdXRjb21lcywgc2VydmVyQWN0aXZpdHkub3V0Y29tZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2FtZU91dGNvbWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5Lm91dGNvbWVzID0gc2VydmVyQWN0aXZpdHkub3V0Y29tZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpdml0eUVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNzcyh7IGxlZnQ6IGFjdGl2aXR5LngsIHRvcDogYWN0aXZpdHkueSB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudG9nZ2xlQ2xhc3MoJ2FjdGl2aXR5LXN0YXJ0JywgYWN0aXZpdHkuaXNTdGFydClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JywgYWN0aXZpdHkuaXNTdGFydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gTWFrZSB0aGUgYWN0aXZpdHkgZHJhZ2dhYmxlLlxuICAgICAgICAgICAgICAgICAgICBwbHVtYmVyLmRyYWdnYWJsZShhY3Rpdml0eUVsZW1lbnQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyaWQ6IFsxMCwgMTBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbm1lbnQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kcmFnU3RhcnQgPSB7IGxlZnQ6IGFyZ3MuZS5zY3JlZW5YLCB0b3A6IGFyZ3MuZS5zY3JlZW5ZIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcDogZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5oYXNEcmFnZ2VkID0gX3RoaXMuZHJhZ1N0YXJ0LmxlZnQgIT0gYXJncy5lLnNjcmVlblggfHwgX3RoaXMuZHJhZ1N0YXJ0LnRvcCAhPSBhcmdzLmUuc2NyZWVuWTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIENvbmZpZ3VyZSB0aGUgYWN0aXZpdHkgYXMgYSB0YXJnZXQuXG4gICAgICAgICAgICAgICAgICAgIHBsdW1iZXIubWFrZVRhcmdldChhY3Rpdml0eUVsZW1lbnQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BPcHRpb25zOiB7IGhvdmVyQ2xhc3M6ICdob3ZlcicgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogJ0NvbnRpbnVvdXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6IFsnQmxhbmsnLCB7IHJhZGl1czogOCB9XVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHNvdXJjZSBlbmRwb2ludHMuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBhY3Rpdml0eS5vdXRjb21lczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdXRjb21lID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNvdXJjZUVuZHBvaW50T3B0aW9ucyA9IF90aGlzLmdldFNvdXJjZUVuZHBvaW50T3B0aW9ucyhhY3Rpdml0eSwgb3V0Y29tZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVtYmVyLmFkZEVuZHBvaW50KGFjdGl2aXR5RWxlbWVudCwgeyBjb25uZWN0b3JPdmVybGF5czogW1snTGFiZWwnLCB7IGxhYmVsOiBvdXRjb21lLmRpc3BsYXlOYW1lLCBjc3NDbGFzczogJ2Nvbm5lY3Rpb24tbGFiZWwnIH1dXSB9LCBzb3VyY2VFbmRwb2ludE9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gQ29ubmVjdCBhY3Rpdml0aWVzLlxuICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZUNvbm5lY3Rpb25zKHBsdW1iZXIpO1xuICAgICAgICAgICAgICAgIC8vIFJlLXF1ZXJ5IHRoZSBhY3Rpdml0eSBlbGVtZW50cy5cbiAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzID0gX3RoaXMuZ2V0QWN0aXZpdHlFbGVtZW50cygpO1xuICAgICAgICAgICAgICAgIC8vIE1ha2UgYWxsIGFjdGl2aXR5IGVsZW1lbnRzIHZpc2libGUuXG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5zaG93KCk7XG4gICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlQ2FudmFzSGVpZ2h0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgcG9wb3ZlcnMuXG4gICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzLmVhY2goZnVuY3Rpb24gKF8sIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlFbGVtZW50ID0gJChpdGVtKTtcbiAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnQucG9wb3Zlcih7XG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdtYW51YWwnLFxuICAgICAgICAgICAgICAgICAgICBodG1sOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGNvbnRlbnQgPSBhY3Rpdml0eUVsZW1lbnQuZmluZCgnLmFjdGl2aXR5LWNvbW1hbmRzJykuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFydEJ1dHRvbiA9ICRjb250ZW50LmZpbmQoJy5hY3Rpdml0eS1zdGFydC1hY3Rpb24nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1N0YXJ0ID0gYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JykgPT09IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlJZCA9IGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1pZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRCdXR0b24uYXR0cignYXJpYS1wcmVzc2VkJywgYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRCdXR0b24udG9nZ2xlQ2xhc3MoJ2FjdGl2ZScsIGlzU3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGNvbnRlbnQub24oJ2NsaWNrJywgJy5hY3Rpdml0eS1zdGFydC1hY3Rpb24nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnV0dG9uID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1N0YXJ0ID0gYnV0dG9uLmlzKCcuYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JywgaXNTdGFydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50LnRvZ2dsZUNsYXNzKCdhY3Rpdml0eS1zdGFydCcsIGlzU3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkY29udGVudC5vbignY2xpY2snLCAnLmFjdGl2aXR5LWRlbGV0ZS1hY3Rpb24nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBUaGUgcHJvbXB0cyBhcmUgcmVhbGx5IGFubm95aW5nLiBDb25zaWRlciBzaG93aW5nIHNvbWUgc29ydCBvZiBzbWFsbCBtZXNzYWdlIGJhbGxvb24gc29tZXdoZXJlIHRvIHVuZG8gdGhlIGFjdGlvbiBpbnN0ZWFkLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgKCFjb25maXJtKHNlbGYuZGVsZXRlQWN0aXZpdHlQcm9tcHQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYud29ya2Zsb3dUeXBlLnJlbW92ZWRBY3Rpdml0aWVzLnB1c2goYWN0aXZpdHlJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1bWJlci5yZW1vdmUoYWN0aXZpdHlFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnQucG9wb3ZlcignZGlzcG9zZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkY29udGVudC5vbignY2xpY2snLCAnW2RhdGEtcGVyc2lzdC13b3JrZmxvd10nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2F2ZUxvY2FsU3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRjb250ZW50LmdldCgwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKGNvbnRhaW5lcikub24oJ2NsaWNrJywgJy5hY3Rpdml0eScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmhhc0RyYWdnZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaGFzRHJhZ2dlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGlmIGFueSBvdGhlciBwb3BvdmVycyBhcmUgdmlzaWJsZSwgaGlkZSB0aGVtXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzUG9wb3ZlclZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5wb3BvdmVyKCdoaWRlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzZW5kZXIgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gICAgICAgICAgICAgICAgc2VuZGVyLnBvcG92ZXIoJ3Nob3cnKTtcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgY2xpY2tpbmcgb24gdGhlIHBvcG92ZXIgaXRzZWxmLlxuICAgICAgICAgICAgICAgICQoJy5wb3BvdmVyJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlMikge1xuICAgICAgICAgICAgICAgICAgICBlMi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIF90aGlzLmlzUG9wb3ZlclZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKGNvbnRhaW5lcikub24oJ2RibGNsaWNrJywgJy5hY3Rpdml0eScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbmRlciA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgaGFzRWRpdG9yID0gc2VuZGVyLmRhdGEoJ2FjdGl2aXR5LWhhcy1lZGl0b3InKTtcbiAgICAgICAgICAgICAgICBpZiAoaGFzRWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnNhdmVMb2NhbFN0YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbmRlci5maW5kKCcuYWN0aXZpdHktZWRpdC1hY3Rpb24nKS5nZXQoMCkuY2xpY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIEhpZGUgYWxsIHBvcG92ZXJzIHdoZW4gY2xpY2tpbmcgYW55d2hlcmUgYnV0IG9uIGFuIGFjdGl2aXR5LlxuICAgICAgICAgICAgJCgnYm9keScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5wb3BvdmVyKCdoaWRlJyk7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNQb3BvdmVyVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBTYXZlIGxvY2FsIGNoYW5nZXMgaWYgdGhlIGV2ZW50IHRhcmdldCBoYXMgdGhlICdkYXRhLXBlcnNpc3Qtd29ya2Zsb3cnIGF0dHJpYnV0ZS5cbiAgICAgICAgICAgICQoJ2JvZHknKS5vbignY2xpY2snLCAnW2RhdGEtcGVyc2lzdC13b3JrZmxvd10nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLnNhdmVMb2NhbFN0YXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF90aGlzLmpzUGx1bWJJbnN0YW5jZSA9IHBsdW1iZXI7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBXb3JrZmxvd0VkaXRvcjtcbn0oV29ya2Zsb3dDYW52YXMpKTtcbiQuZm4ud29ya2Zsb3dFZGl0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xuICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuICAgICAgICB2YXIgd29ya2Zsb3dUeXBlID0gJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3ctdHlwZScpO1xuICAgICAgICB2YXIgZGVsZXRlQWN0aXZpdHlQcm9tcHQgPSAkZWxlbWVudC5kYXRhKCd3b3JrZmxvdy1kZWxldGUtYWN0aXZpdHktcHJvbXB0Jyk7XG4gICAgICAgIHZhciBsb2NhbElkID0gJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3ctbG9jYWwtaWQnKTtcbiAgICAgICAgdmFyIGxvYWRMb2NhbFN0YXRlID0gJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3ctbG9hZC1sb2NhbC1zdGF0ZScpO1xuICAgICAgICB3b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXMgPSB3b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXMgfHwgW107XG4gICAgICAgICRlbGVtZW50LmRhdGEoJ3dvcmtmbG93RWRpdG9yJywgbmV3IFdvcmtmbG93RWRpdG9yKGVsZW1lbnQsIHdvcmtmbG93VHlwZSwgZGVsZXRlQWN0aXZpdHlQcm9tcHQsIGxvY2FsSWQsIGxvYWRMb2NhbFN0YXRlKSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgIHZhciB3b3JrZmxvd0VkaXRvciA9ICQoJy53b3JrZmxvdy1jYW52YXMnKS53b3JrZmxvd0VkaXRvcigpLmRhdGEoJ3dvcmtmbG93RWRpdG9yJyk7XG4gICAgJCgnI3dvcmtmbG93RWRpdG9yRm9ybScpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbiAocywgZSkge1xuICAgICAgICB2YXIgc3RhdGUgPSB3b3JrZmxvd0VkaXRvci5zZXJpYWxpemUoKTtcbiAgICAgICAgJCgnI3dvcmtmbG93U3RhdGVJbnB1dCcpLnZhbChzdGF0ZSk7XG4gICAgfSk7XG59KTtcbiIsIi8vLzxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uLy4uL0Fzc2V0cy9MaWIvanF1ZXJ5L3R5cGluZ3MuZC50c1wiIC8+XHJcblxyXG4kKCgpID0+IHtcclxuICAgIGNvbnN0IGdlbmVyYXRlV29ya2Zsb3dVcmwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3Qgd29ya2Zsb3dUeXBlSWQ6IHN0cmluZyA9ICQoJ1tkYXRhLXdvcmtmbG93LXR5cGUtaWRdJykuZGF0YSgnd29ya2Zsb3ctdHlwZS1pZCcpO1xyXG4gICAgICAgIGNvbnN0IGFjdGl2aXR5SWQ6IHN0cmluZyA9ICQoJ1tkYXRhLWFjdGl2aXR5LWlkXScpLmRhdGEoJ2FjdGl2aXR5LWlkJyk7XHJcbiAgICAgICAgdmFyIHRva2VuTGlmZVNwYW4gPSAkKCcjdG9rZW4tbGlmZXNwYW4nKS52YWwoKTtcclxuICAgICAgICBjb25zdCBnZW5lcmF0ZVVybDogc3RyaW5nID0gJCgnW2RhdGEtZ2VuZXJhdGUtdXJsXScpLmRhdGEoJ2dlbmVyYXRlLXVybCcpICsgYD93b3JrZmxvd1R5cGVJZD0ke3dvcmtmbG93VHlwZUlkfSZhY3Rpdml0eUlkPSR7YWN0aXZpdHlJZH0mdG9rZW5MaWZlU3Bhbj0ke3Rva2VuTGlmZVNwYW59YDtcclxuICAgICAgICBjb25zdCBhbnRpZm9yZ2VyeUhlYWRlck5hbWU6IHN0cmluZyA9ICQoJ1tkYXRhLWFudGlmb3JnZXJ5LWhlYWRlci1uYW1lXScpLmRhdGEoJ2FudGlmb3JnZXJ5LWhlYWRlci1uYW1lJyk7XHJcbiAgICAgICAgY29uc3QgYW50aWZvcmdlcnlUb2tlbjogc3RyaW5nID0gJCgnW2RhdGEtYW50aWZvcmdlcnktdG9rZW5dJykuZGF0YSgnYW50aWZvcmdlcnktdG9rZW4nKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJzOiBhbnkgPSB7fTtcclxuXHJcbiAgICAgICAgaGVhZGVyc1thbnRpZm9yZ2VyeUhlYWRlck5hbWVdID0gYW50aWZvcmdlcnlUb2tlbjtcclxuXHJcbiAgICAgICAgJC5wb3N0KHtcclxuICAgICAgICAgICAgdXJsOiBnZW5lcmF0ZVVybCxcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyc1xyXG4gICAgICAgIH0pLmRvbmUodXJsID0+IHtcclxuICAgICAgICAgICAgJCgnI3dvcmtmbG93LXVybC10ZXh0JykudmFsKHVybCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICQoJyNnZW5lcmF0ZS11cmwtYnV0dG9uJykub24oJ2NsaWNrJywgZSA9PiB7XHJcbiAgICAgICAgZ2VuZXJhdGVXb3JrZmxvd1VybCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKCQoJyN3b3JrZmxvdy11cmwtdGV4dCcpLnZhbCgpID09ICcnKSB7XHJcbiAgICAgICAgZ2VuZXJhdGVXb3JrZmxvd1VybCgpO1xyXG4gICAgfVxyXG59KTtcclxuIiwiLy8vPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vLi4vQXNzZXRzL0xpYi9qcXVlcnkvdHlwaW5ncy5kLnRzXCIgLz5cbiQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBnZW5lcmF0ZVdvcmtmbG93VXJsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgd29ya2Zsb3dUeXBlSWQgPSAkKCdbZGF0YS13b3JrZmxvdy10eXBlLWlkXScpLmRhdGEoJ3dvcmtmbG93LXR5cGUtaWQnKTtcbiAgICAgICAgdmFyIGFjdGl2aXR5SWQgPSAkKCdbZGF0YS1hY3Rpdml0eS1pZF0nKS5kYXRhKCdhY3Rpdml0eS1pZCcpO1xuICAgICAgICB2YXIgdG9rZW5MaWZlU3BhbiA9ICQoJyN0b2tlbi1saWZlc3BhbicpLnZhbCgpO1xuICAgICAgICB2YXIgZ2VuZXJhdGVVcmwgPSAkKCdbZGF0YS1nZW5lcmF0ZS11cmxdJykuZGF0YSgnZ2VuZXJhdGUtdXJsJykgKyBcIj93b3JrZmxvd1R5cGVJZD1cIi5jb25jYXQod29ya2Zsb3dUeXBlSWQsIFwiJmFjdGl2aXR5SWQ9XCIpLmNvbmNhdChhY3Rpdml0eUlkLCBcIiZ0b2tlbkxpZmVTcGFuPVwiKS5jb25jYXQodG9rZW5MaWZlU3Bhbik7XG4gICAgICAgIHZhciBhbnRpZm9yZ2VyeUhlYWRlck5hbWUgPSAkKCdbZGF0YS1hbnRpZm9yZ2VyeS1oZWFkZXItbmFtZV0nKS5kYXRhKCdhbnRpZm9yZ2VyeS1oZWFkZXItbmFtZScpO1xuICAgICAgICB2YXIgYW50aWZvcmdlcnlUb2tlbiA9ICQoJ1tkYXRhLWFudGlmb3JnZXJ5LXRva2VuXScpLmRhdGEoJ2FudGlmb3JnZXJ5LXRva2VuJyk7XG4gICAgICAgIHZhciBoZWFkZXJzID0ge307XG4gICAgICAgIGhlYWRlcnNbYW50aWZvcmdlcnlIZWFkZXJOYW1lXSA9IGFudGlmb3JnZXJ5VG9rZW47XG4gICAgICAgICQucG9zdCh7XG4gICAgICAgICAgICB1cmw6IGdlbmVyYXRlVXJsLFxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyc1xuICAgICAgICB9KS5kb25lKGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgICAgICQoJyN3b3JrZmxvdy11cmwtdGV4dCcpLnZhbCh1cmwpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgICQoJyNnZW5lcmF0ZS11cmwtYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZ2VuZXJhdGVXb3JrZmxvd1VybCgpO1xuICAgIH0pO1xuICAgIGlmICgkKCcjd29ya2Zsb3ctdXJsLXRleHQnKS52YWwoKSA9PSAnJykge1xuICAgICAgICBnZW5lcmF0ZVdvcmtmbG93VXJsKCk7XG4gICAgfVxufSk7XG4iXX0=
